"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("ag-grid-community"),t=function(){function e(){this.ieCompatibility=!1}return e.prototype.init=function(){this.ieCompatibility="5d41402abc4b2a76b9719d911017c592"!=this.md5("hello")},e.prototype.md5cycle=function(e,t){var r=e[0],i=e[1],o=e[2],n=e[3];r=this.ff(r,i,o,n,t[0],7,-680876936),n=this.ff(n,r,i,o,t[1],12,-389564586),o=this.ff(o,n,r,i,t[2],17,606105819),i=this.ff(i,o,n,r,t[3],22,-1044525330),r=this.ff(r,i,o,n,t[4],7,-176418897),n=this.ff(n,r,i,o,t[5],12,1200080426),o=this.ff(o,n,r,i,t[6],17,-1473231341),i=this.ff(i,o,n,r,t[7],22,-45705983),r=this.ff(r,i,o,n,t[8],7,1770035416),n=this.ff(n,r,i,o,t[9],12,-1958414417),o=this.ff(o,n,r,i,t[10],17,-42063),i=this.ff(i,o,n,r,t[11],22,-1990404162),r=this.ff(r,i,o,n,t[12],7,1804603682),n=this.ff(n,r,i,o,t[13],12,-40341101),o=this.ff(o,n,r,i,t[14],17,-1502002290),i=this.ff(i,o,n,r,t[15],22,1236535329),r=this.gg(r,i,o,n,t[1],5,-165796510),n=this.gg(n,r,i,o,t[6],9,-1069501632),o=this.gg(o,n,r,i,t[11],14,643717713),i=this.gg(i,o,n,r,t[0],20,-373897302),r=this.gg(r,i,o,n,t[5],5,-701558691),n=this.gg(n,r,i,o,t[10],9,38016083),o=this.gg(o,n,r,i,t[15],14,-660478335),i=this.gg(i,o,n,r,t[4],20,-405537848),r=this.gg(r,i,o,n,t[9],5,568446438),n=this.gg(n,r,i,o,t[14],9,-1019803690),o=this.gg(o,n,r,i,t[3],14,-187363961),i=this.gg(i,o,n,r,t[8],20,1163531501),r=this.gg(r,i,o,n,t[13],5,-1444681467),n=this.gg(n,r,i,o,t[2],9,-51403784),o=this.gg(o,n,r,i,t[7],14,1735328473),i=this.gg(i,o,n,r,t[12],20,-1926607734),r=this.hh(r,i,o,n,t[5],4,-378558),n=this.hh(n,r,i,o,t[8],11,-2022574463),o=this.hh(o,n,r,i,t[11],16,1839030562),i=this.hh(i,o,n,r,t[14],23,-35309556),r=this.hh(r,i,o,n,t[1],4,-1530992060),n=this.hh(n,r,i,o,t[4],11,1272893353),o=this.hh(o,n,r,i,t[7],16,-155497632),i=this.hh(i,o,n,r,t[10],23,-1094730640),r=this.hh(r,i,o,n,t[13],4,681279174),n=this.hh(n,r,i,o,t[0],11,-358537222),o=this.hh(o,n,r,i,t[3],16,-722521979),i=this.hh(i,o,n,r,t[6],23,76029189),r=this.hh(r,i,o,n,t[9],4,-640364487),n=this.hh(n,r,i,o,t[12],11,-421815835),o=this.hh(o,n,r,i,t[15],16,530742520),i=this.hh(i,o,n,r,t[2],23,-995338651),r=this.ii(r,i,o,n,t[0],6,-198630844),n=this.ii(n,r,i,o,t[7],10,1126891415),o=this.ii(o,n,r,i,t[14],15,-1416354905),i=this.ii(i,o,n,r,t[5],21,-57434055),r=this.ii(r,i,o,n,t[12],6,1700485571),n=this.ii(n,r,i,o,t[3],10,-1894986606),o=this.ii(o,n,r,i,t[10],15,-1051523),i=this.ii(i,o,n,r,t[1],21,-2054922799),r=this.ii(r,i,o,n,t[8],6,1873313359),n=this.ii(n,r,i,o,t[15],10,-30611744),o=this.ii(o,n,r,i,t[6],15,-1560198380),i=this.ii(i,o,n,r,t[13],21,1309151649),r=this.ii(r,i,o,n,t[4],6,-145523070),n=this.ii(n,r,i,o,t[11],10,-1120210379),o=this.ii(o,n,r,i,t[2],15,718787259),i=this.ii(i,o,n,r,t[9],21,-343485551),e[0]=this.add32(r,e[0]),e[1]=this.add32(i,e[1]),e[2]=this.add32(o,e[2]),e[3]=this.add32(n,e[3])},e.prototype.cmn=function(e,t,r,i,o,n){return t=this.add32(this.add32(t,e),this.add32(i,n)),this.add32(t<<o|t>>>32-o,r)},e.prototype.ff=function(e,t,r,i,o,n,a){return this.cmn(t&r|~t&i,e,t,o,n,a)},e.prototype.gg=function(e,t,r,i,o,n,a){return this.cmn(t&i|r&~i,e,t,o,n,a)},e.prototype.hh=function(e,t,r,i,o,n,a){return this.cmn(t^r^i,e,t,o,n,a)},e.prototype.ii=function(e,t,r,i,o,n,a){return this.cmn(r^(t|~i),e,t,o,n,a)},e.prototype.md51=function(e){var t,r=e.length,i=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)this.md5cycle(i,this.md5blk(e.substring(t-64,t)));e=e.substring(t-64);var o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)o[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(o[t>>2]|=128<<(t%4<<3),t>55)for(this.md5cycle(i,o),t=0;t<16;t++)o[t]=0;return o[14]=8*r,this.md5cycle(i,o),i},e.prototype.md5blk=function(e){for(var t=[],r=0;r<64;r+=4)t[r>>2]=e.charCodeAt(r)+(e.charCodeAt(r+1)<<8)+(e.charCodeAt(r+2)<<16)+(e.charCodeAt(r+3)<<24);return t},e.prototype.rhex=function(e){for(var t="0123456789abcdef".split(""),r="",i=0;i<4;i++)r+=t[e>>8*i+4&15]+t[e>>8*i&15];return r},e.prototype.hex=function(e){for(var t=0;t<e.length;t++)e[t]=this.rhex(e[t]);return e.join("")},e.prototype.md5=function(e){return this.hex(this.md51(e))},e.prototype.add32=function(e,t){return this.ieCompatibility?this.add32Compat(e,t):this.add32Std(e,t)},e.prototype.add32Std=function(e,t){return e+t&4294967295},e.prototype.add32Compat=function(e,t){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r},e}(),r=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,o,n=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(e){o={error:e}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a};function i(e){return null==e||0===e.length}var o,n={"01":"GRID","02":"CHARTS","0102":"BOTH"},a=function(){function e(e){this.watermarkMessage=void 0,this.document=e,this.md5=new t,this.md5.init()}return e.prototype.else if(t.valid){if(t.isTrial&&t.trialExpired)this.outputExpiredTrialKey(t.expiry);else if(t.expired){var r=e.getGridReleaseDate(),i=e.formatDate(r);this.outputIncompatibleVersion(t.expiry,i)}}else this.outputInvalidLicenseKey(t.incorrectLicenseType,t.licenseType)},e.extractExpiry=function(t){var r=t.substring(t.lastIndexOf("_")+1,t.length);return new Date(parseInt(e.decode(r),10))},e.extractLicenseComponents=function(t){var i=t.replace(/[\u200B-\u200D\uFEFF]/g,"");if(i=i.replace(/\r?\n|\r/g,""),t.length<=32)return{md5:null,license:t,version:null,isTrial:null};var o=i.length-32,n=i.substring(o),a=i.substring(0,o),s=r(e.extractBracketedInformation(i),3);return{md5:n,license:a,version:s[0],isTrial:s[1],type:s[2]}},e.prototype.getLicenseDetails=function(t){if(i(t))return{var r=e.getGridReleaseDate(),o=e.extractLicenseComponents(t),a=o.md5,s=o.license,l=o.version,c=o.isTrial,u=o.type,d=a===this.md5.md5(s)&&-1===t.indexOf("For_Trialing_ag-Grid_Only"),p=void 0,h=void 0,f=null,g=void 0,y=void 0;function v(){var e=new Date;p=f<e,h=void 0}if(d&&(f=e.extractExpiry(s),d=!isNaN(f.getTime())))switch(h=r>f,l){case"legacy":case"2":c&&v();break;case"3":i(u)?d=!1:u!==n["01"]&&u!==n["0102"]?(d=!1,g=!0,y=u):c&&v()}return d?{return void 0===e?"":e},e.prototype.isForceWatermark=function(){var e=(this.document.defaultView||window).location.pathname;return!!e&&-1!==e.indexOf("forceWatermark")},e.prototype.isWebsiteUrl=function(){return null!==this.getHostname().match(/^((?:\w+\.)?ag-grid\.com)$/)},e.prototype.isLocalhost=function(){return null!==this.getHostname().match(/^(?:127\.0\.0\.1|localhost)$/)},e.formatDate=function(e){var t=e.getDate(),r=e.getMonth(),i=e.getFullYear();return t+" "+["January","February","March","April","May","June","July","August","September","October","November","December"][r]+" "+i},e.getGridReleaseDate=function(){return new Date(parseInt(e.decode(e.RELEASE_INFORMATION),10))},e.decode=function(t){for(var r,i,o,n,a,s,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="",u=0,d=t.replace(/[^A-Za-z0-9+/=]/g,"");u<d.length;)r=l.indexOf(d.charAt(u++))<<2|(n=l.indexOf(d.charAt(u++)))>>4,i=(15&n)<<4|(a=l.indexOf(d.charAt(u++)))>>2,o=(3&a)<<6|(s=l.indexOf(d.charAt(u++))),c+=String.fromCharCode(r),64!=a&&(c+=String.fromCharCode(i)),64!=s&&(c+=String.fromCharCode(o));return c=e.utf8_decode(c)},e.utf8_decode=function(e){e=e.replace(/rn/g,"n");for(var t="",r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t+=String.fromCharCode(i):i>127&&i<2048?(t+=String.fromCharCode(i>>6|192),t+=String.fromCharCode(63&i|128)):(t+=String.fromCharCode(i>>12|224),t+=String.fromCharCode(i>>6&63|128),t+=String.fromCharCode(63&i|128))}return t},e.if(!t||0===t.length)return["legacy",!1,void 0];var r=1===t.filter((function(e){return"TRIAL"===e})).length,i=t.filter((function(e){return 0===e.indexOf("v")}))[0];return[i?i.replace("v",""):"legacy",r,n[t.filter((function(e){return n[e]}))[0]]]},e.prototype.outputInvalidLicenseKey=function(e,t){var r,i;console.error("*****************************************************************************************************************"),console.error("***************************************** AG Grid Enterprise License ********************************************"),console.error("********************************************* Invalid License ***************************************************"),void 0===i&&(i=!1),null!=(r=e)&&(""!==r||i)&&e&&"CHARTS"===t&&console.error("* The license supplied is for AG Charts Enterprise Only and does not cover AG Grid Enterprise                   *"),console.error("* Your license for AG Grid Enterprise is not valid - please contact info@ag-grid.com to obtain a valid license. *"),console.error("*****************************************************************************************************************"),console.error("*****************************************************************************************************************"),this.watermarkMessage="Invalid License"},e.prototype.outputExpiredTrialKey=function(e){console.error("****************************************************************************************************************"),console.error("***************************************** AG Grid Enterprise License *******************************************"),console.error("*****************************************   Trial Period Expired.    *******************************************"),console.error("* Your license for AG Grid Enterprise expired on ".concat(e,".                                                *")),console.error("* Please email info@ag-grid.com to purchase a license.                                                         *"),console.error("****************************************************************************************************************"),console.error("****************************************************************************************************************"),this.watermarkMessage="Trial Period Expired"},e.prototype.outputMissingLicenseKey=function(){console.error("****************************************************************************************************************"),console.error("***************************************** AG Grid Enterprise License *******************************************"),console.error("****************************************** License Key Not Found ***********************************************"),console.error("* All AG Grid Enterprise features are unlocked.                                                                *"),console.error("* This is an evaluation only version, it is not licensed for development projects intended for production.     *"),console.error("* If you want to hide the watermark, please email info@ag-grid.com for a trial license.                        *"),console.error("****************************************************************************************************************"),console.error("****************************************************************************************************************"),this.watermarkMessage="For Trial Use Only"},e.prototype.outputIncompatibleVersion=function(e,t){console.error("****************************************************************************************************************************"),console.error("****************************************************************************************************************************"),console.error("*                                             AG Grid Enterprise License                                                   *"),console.error("*                           License not compatible with installed version of AG Grid Enterprise.                           *"),console.error("*                                                                                                                          *"),console.error("* Your AG Grid License entitles you to all versions of AG Grid that we release within the time covered by your license     *"),console.error("* - typically we provide one year licenses which entitles you to all releases / updates of AG Grid within that year.       *"),console.error("* Your license has an end (expiry) date which stops the license key working with versions of AG Grid released after the    *"),console.error("* license end date. The license key that you have expires on ".concat(e,", however the version of AG Grid you    *")),console.error("* are trying to use was released on ".concat(t,".                                                               *")),console.error("*                                                                                                                          *"),console.error("* Please contact info@ag-grid.com to renew your subscription to new versions and get a new license key to work with this   *"),console.error("* version of AG Grid.                                                                                                      *"),console.error("****************************************************************************************************************************"),console.error("****************************************************************************************************************************"),this.watermarkMessage="License Expired"},e.RELEASE_INFORMATION="MTcwNjE5NzMxMzM3Mg==",e}(),s=(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),l=function(e,t,r,i){var o,n=arguments.length,a=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(n<3?o(a):n>3?o(t,r,a):o(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a},c=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return s(r,t),r.prototype.return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),d=function(e,t,r,i){var o,n=arguments.length,a=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(n<3?o(a):n>3?o(t,r,a):o(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a},p=function(t){function r(){return t.call(this,'<div class="ag-watermark">\n                <div ref="eLicenseTextRef" class="ag-watermark-text"></div>\n            </div>')||this}return u(r,t),r.prototype.postConstruct=function(){var e=this,t=this.shouldDisplayWatermark();this.setDisplayed(t),t&&(this.eLicenseTextRef.innerText=this.licenseManager.getWatermarkMessage(),window.setTimeout((function(){return e.addCssClass("ag-opacity-zero")}),0),window.setTimeout((function(){return e.setDisplayed(!1)}),5e3))},r.prototype.shouldDisplayWatermark=function(){return this.licenseManager.isDisplayWatermark()},d([e.Autowired("licenseManager")],r.prototype,"licenseManager",void 0),d([e.RefSelector("eLicenseTextRef")],r.prototype,"eLicenseTextRef",void 0),d([e.PostConstruct],r.prototype,"postConstruct",null),r}(e.Component),h={version:"31.0.3",moduleName:e.ModuleNames.EnterpriseCoreModule,beans:[c],agStackComponents:[{componentName:"AgWatermark",componentClass:p}]},f=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),g=function(e,t,r,i){var o,n=arguments.length,a=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(n<3?o(a):n>3?o(t,r,a):o(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a},y=function(t){function r(e){var r=t.call(this,'\n            <div class="ag-advanced-filter-header" role="row">\n            </div>')||this;return r.enabled=e,r}return f(r,t),r.prototype.postConstruct=function(){var t=this;this.setupAdvancedFilter(this.enabled),this.addDestroyFunc((function(){return t.destroyBean(t.eAdvancedFilter)})),this.addManagedListener(this.eventService,e.Events.EVENT_GRID_COLUMNS_CHANGED,(function(){return t.onGridColumnsChanged()})),this.addGuiEventListener("keydown",(function(e){return t.onKeyDown(e)})),this.addGuiEventListener("focusout",(function(e){t.getFocusableElement().contains(e.relatedTarget)||t.focusService.clearAdvancedFilterColumn()}))},r.prototype.getFocusableElement=function(){var e,t;return null!==(t=null===(e=this.eAdvancedFilter)||void 0===e?void 0:e.getGui())&&void 0!==t?t:this.getGui()},r.prototype.setEnabled=function(e){e!==this.enabled&&this.setupAdvancedFilter(e)},r.prototype.refresh=function(){var e;null===(e=this.eAdvancedFilter)||void 0===e||e.refresh()},r.prototype.getHeight=function(){return this.height},r.prototype.setInputDisabled=function(e){var t;null===(t=this.eAdvancedFilter)||void 0===t||t.setInputDisabled(e)},r.prototype.setupAdvancedFilter=function(t){var r=this.getGui();if(t){this.eAdvancedFilter=this.createBean(new oe);var i=this.eAdvancedFilter.getGui();this.eAdvancedFilter.addCssClass("ag-advanced-filter-header-cell"),this.height=this.columnModel.getFloatingFiltersHeight();var o="".concat(this.height,"px");r.style.height=o,r.style.minHeight=o,this.setAriaRowIndex(),e._.setAriaRole(i,"gridcell"),e._.setAriaColIndex(i,1),this.setAriaColumnCount(i),r.appendChild(i)}else e._.clearElement(r),this.destroyBean(this.eAdvancedFilter),this.height=0;e._.setDisplayed(r,t),this.enabled=t},r.prototype.setAriaColumnCount=function(t){e._.setAriaColSpan(t,this.columnModel.getAllGridColumns().length)},r.prototype.setAriaRowIndex=function(){e._.setAriaRowIndex(this.getGui(),this.headerNavigationService.getHeaderRowCount())},r.prototype.onGridColumnsChanged=function(){this.eAdvancedFilter&&(this.setAriaColumnCount(this.eAdvancedFilter.getGui()),this.setAriaRowIndex())},r.prototype.onKeyDown=function(t){switch(t.key){case e.KeyCode.ENTER:this.hasFocus()&&this.focusService.focusInto(this.getFocusableElement())&&t.preventDefault();break;case e.KeyCode.ESCAPE:this.hasFocus()||this.getFocusableElement().focus();break;case e.KeyCode.UP:this.navigateUpDown(!0,t);break;case e.KeyCode.DOWN:this.navigateUpDown(!1,t);break;case e.KeyCode.TAB:if(this.hasFocus())this.navigateLeftRight(t);else{var r=this.focusService.findNextFocusableElement(this.getFocusableElement(),null,t.shiftKey);r?(t.preventDefault(),r.focus()):this.navigateLeftRight(t)}}},r.prototype.navigateUpDown=function(e,t){this.hasFocus()&&this.focusService.focusNextFromAdvancedFilter(e)&&t.preventDefault()},r.prototype.navigateLeftRight=function(e){(e.shiftKey?this.focusService.focusLastHeader():this.focusService.focusNextFromAdvancedFilter(!1,!0))&&e.preventDefault()},r.prototype.hasFocus=function(){return this.gridOptionsService.getDocument().activeElement===this.getFocusableElement()},g([e.Autowired("columnModel")],r.prototype,"columnModel",void 0),g([e.Autowired("focusService")],r.prototype,"focusService",void 0),g([e.Autowired("headerNavigationService")],r.prototype,"headerNavigationService",void 0),g([e.PostConstruct],r.prototype,"postConstruct",null),r}(e.Component),v=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),m=function(){return(m=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},C=function(t){function r(e){var r=t.call(this,m(m({},e),{template:'\n                <div class="ag-picker-field" role="presentation">\n                    <div ref="eLabel"></div>\n                    <div ref="eWrapper" class="ag-wrapper ag-picker-collapsed">\n                        <div ref="eDisplayField" class="ag-picker-field-display"></div>\n                        <ag-input-text-field ref="eInput" class="ag-rich-select-field-input"></ag-input-text-field>\n                        <div ref="eIcon" class="ag-picker-field-icon" aria-hidden="true"></div>\n                    </div>\n                </div>'}))||this;return r.params=e,r}return v(r,t),r.prototype.showPicker=function(){var e=this;setTimeout((function(){return t.prototype.showPicker.call(e)}))},r.prototype.hidePicker=function(){var e=this;setTimeout((function(){return t.prototype.hidePicker.call(e)}))},r.prototype.postConstruct=function(){t.prototype.postConstruct.call(this);var r=this.params,i=r.wrapperClassName,o=r.ariaLabel;e._.setDisplayed(this.eDisplayField,!1),i&&this.eWrapper.classList.add(i),e._.setAriaLabelledBy(this.eWrapper,""),e._.setAriaLabel(this.eWrapper,o)},r.prototype.onEnterKeyDown=function(r){e._.stopPropagationForAgGrid(r),this.isPickerDisplayed?t.prototype.onEnterKeyDown.call(this,r):(r.preventDefault(),this.showPicker())},r}(e.AgRichSelect),b=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),S=function(e,t,r,i){var o,n=arguments.length,a=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(n<3?o(a):n>3?o(t,r,a):o(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a},x=function(t){function r(e,r){var i=t.call(this)||this;return i.comp=e,i.virtualList=r,i}return b(r,t),r.prototype.postConstruct=function(){var t=this;this.createManagedBean(new e.VirtualListDragFeature(this.comp,this.virtualList,{dragSourceType:e.DragSourceType.AdvancedFilterBuilder,listItemDragStartEvent:r.EVENT_DRAG_STARTED,listItemDragEndEvent:r.EVENT_DRAG_ENDED,eventSource:this,getCurrentDragValue:function(e){return t.getCurrentDragValue(e)},isMoveBlocked:function(){return!1},getNumRows:function(e){return e.getNumItems()},moveItem:function(e,r){return t.moveItem(e,r)}}))},r.prototype.getCurrentDragValue=function(e){return e.item},r.prototype.moveItem=function(e,t){this.comp.moveItem(e,t)},r.EVENT_DRAG_STARTED="advancedFilterBuilderDragStarted",r.EVENT_DRAG_ENDED="advancedFilterBuilderDragEnded",S([e.PostConstruct],r.prototype,"postConstruct",null),r}(e.BeanStub),w=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),E=function(e,t,r,i){var o,n=arguments.length,a=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(n<3?o(a):n>3?o(t,r,a):o(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a},A=function(t){function r(e,r,i){var o=t.call(this)||this;return o.eGui=e,o.focusWrapper=r,o.eFocusableComp=i,o}return w(r,t),r.prototype.postConstruct=function(){var t=this;this.addManagedListener(this.eGui,"keydown",(function(r){switch(r.key){case e.KeyCode.TAB:r.defaultPrevented||e._.stopPropagationForAgGrid(r);break;case e.KeyCode.UP:case e.KeyCode.DOWN:e._.stopPropagationForAgGrid(r);break;case e.KeyCode.ESCAPE:if(e._.isStopPropagationForAgGrid(r))return;var i=t.gridOptionsService.getDocument();t.eGui.contains(i.activeElement)&&(r.preventDefault(),e._.stopPropagationForAgGrid(r),t.focusWrapper.focus())}})),this.addManagedListener(this.focusWrapper,"keydown",(function(r){switch(r.key){case e.KeyCode.ENTER:if(e._.isStopPropagationForAgGrid(r))return;t.gridOptionsService.getDocument().activeElement===t.focusWrapper&&(r.preventDefault(),e._.stopPropagationForAgGrid(r),t.eFocusableComp.getFocusableElement().focus())}})),this.addManagedListener(this.focusWrapper,"focusin",(function(){t.focusWrapper.classList.add("ag-advanced-filter-builder-virtual-list-item-highlight")})),this.addManagedListener(this.focusWrapper,"focusout",(function(e){t.focusWrapper.contains(e.relatedTarget)||t.focusWrapper.classList.remove("ag-advanced-filter-builder-virtual-list-item-highlight")}))},E([e.PostConstruct],r.prototype,"postConstruct",null),r}(e.BeanStub);function O(e,t){return{pickerAriaLabelKey:"ariaLabelAdvancedFilterBuilderAddField",pickerAriaLabelValue:"Advanced Filter Builder Add Field",pickerType:"ag-list",valueList:[{key:"condition",displayValue:e("advancedFilterBuilderAddCondition")},{key:"join",displayValue:e("advancedFilterBuilderAddJoin")}],valueFormatter:function(e){var t;return null==e?null:null!==(t=e.displayValue)&&void 0!==t?t:e.key},pickerIcon:"advancedFilterBuilderAdd",maxPickerWidth:"".concat(null!=t?t:120,"px"),wrapperClassName:"ag-advanced-filter-builder-item-button",ariaLabel:e("advancedFilterBuilderAddButtonTooltip")}}var P=function(){function e(){}return e.EVENT_ADDED="advancedFilterBuilderAdded",e.EVENT_MOVED="advancedFilterBuilderMoved",e.EVENT_REMOVED="advancedFilterBuilderRemoved",e.EVENT_VALUE_CHANGED="advancedFilterBuilderValueChanged",e.EVENT_VALID_CHANGED="advancedFilterBuilderValidChanged",e}(),T=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),D=function(e,t,r,i){var o,n=arguments.length,a=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(n<3?o(a):n>3?o(t,r,a):o(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a},R=function(t){function r(){var e=t.call(this,'\n            <div class="ag-advanced-filter-builder-item-condition" role="presentation"></div>\n        ')||this;return e.validationMessage=null,e}return T(r,t),r.prototype.init=function(e){var t=this,r=e.item,i=e.createPill;this.item=r,this.createPill=i,this.filterModel=r.filterModel,this.setupColumnCondition(this.filterModel),this.validate(),this.addDestroyFunc((function(){return t.destroyBeans([t.eColumnPill,t.eOperatorPill,t.eOperandPill])}))},r.prototype.getDragName=function(){return this.filterModel.colId?this.advancedFilterExpressionService.parseColumnFilterModel(this.filterModel):this.getDefaultColumnDisplayValue()},r.prototype.getAriaLabel=function(){return"".concat(this.advancedFilterExpressionService.translate("ariaAdvancedFilterBuilderFilterItem")," ").concat(this.getDragName())},r.prototype.getValidationMessage=function(){return this.validationMessage},r.prototype.getFocusableElement=function(){return this.eColumnPill.getFocusableElement()},r.prototype.setupColumnCondition=function(t){var r,i=this,o=this.advancedFilterExpressionService.getColumnDetails(t.colId);this.baseCellDataType=o.baseCellDataType,this.column=o.column,this.numOperands=this.getNumOperands(this.getOperatorKey()),this.eColumnPill=this.createPill({key:this.getColumnKey(),displayValue:null!==(r=this.getColumnDisplayValue())&&void 0!==r?r:this.getDefaultColumnDisplayValue(),cssClass:"ag-advanced-filter-builder-column-pill",isSelect:!0,getEditorParams:function(){return{values:i.advancedFilterExpressionService.getColumnAutocompleteEntries()}},update:function(e){return i.setColumnKey(e)},pickerAriaLabelKey:"ariaLabelAdvancedFilterBuilderColumnSelectField",pickerAriaLabelValue:"Advanced Filter Builder Column Select Field",ariaLabel:this.advancedFilterExpressionService.translate("ariaAdvancedFilterBuilderColumn")}),this.getGui().appendChild(this.eColumnPill.getGui()),e._.exists(this.getColumnKey())&&(this.createOperatorPill(),this.hasOperand()&&this.createOperandPill())},r.prototype.createOperatorPill=function(){var e,t=this;this.eOperatorPill=this.createPill({key:this.getOperatorKey(),displayValue:null!==(e=this.getOperatorDisplayValue())&&void 0!==e?e:this.getDefaultOptionSelectValue(),cssClass:"ag-advanced-filter-builder-option-pill",isSelect:!0,getEditorParams:function(){return{values:t.getOperatorAutocompleteEntries()}},update:function(e){return t.setOperatorKey(e)},pickerAriaLabelKey:"ariaLabelAdvancedFilterBuilderOptionSelectField",pickerAriaLabelValue:"Advanced Filter Builder Option Select Field",ariaLabel:this.advancedFilterExpressionService.translate("ariaAdvancedFilterBuilderOption")}),this.eColumnPill.getGui().insertAdjacentElement("afterend",this.eOperatorPill.getGui())},r.prototype.createOperandPill=function(){var e,t=this,r=null!==(e=this.getOperandDisplayValue())&&void 0!==e?e:"";this.eOperandPill=this.createPill({key:r,displayValue:r,baseCellDataType:this.baseCellDataType,cssClass:"ag-advanced-filter-builder-value-pill",isSelect:!1,update:function(e){return t.setOperand(e)},ariaLabel:this.advancedFilterExpressionService.translate("ariaAdvancedFilterBuilderValue")}),this.getGui().appendChild(this.eOperandPill.getGui())},r.prototype.getColumnKey=function(){return this.filterModel.colId},r.prototype.getColumnDisplayValue=function(){return this.advancedFilterExpressionService.getColumnDisplayValue(this.filterModel)},r.prototype.getOperatorKey=function(){return this.filterModel.type},r.prototype.getOperatorDisplayValue=function(){return this.advancedFilterExpressionService.getOperatorDisplayValue(this.filterModel)},r.prototype.getOperandDisplayValue=function(){return this.advancedFilterExpressionService.getOperandDisplayValue(this.filterModel,!0)},r.prototype.hasOperand=function(){return this.numOperands>0},r.prototype.getOperatorAutocompleteEntries=function(){return this.column?this.advancedFilterExpressionService.getOperatorAutocompleteEntries(this.column,this.baseCellDataType):[]},r.prototype.setColumnKey=function(t){this.eOperatorPill||this.createOperatorPill();var r=this.advancedFilterExpressionService.getColumnDetails(t);this.column=r.column;var i=r.baseCellDataType;this.baseCellDataType!==i&&(this.baseCellDataType=i,this.setOperatorKey(void 0),this.eOperatorPill&&(e._.removeFromParent(this.eOperatorPill.getGui()),this.destroyBean(this.eOperatorPill),this.createOperatorPill()),this.validate()),this.filterModel.colId=t,this.filterModel.filterType=this.baseCellDataType},r.prototype.setOperatorKey=function(e){var t=this.getNumOperands(e);t!==this.numOperands&&(this.numOperands=t,0===t?this.destroyOperandPill():(this.createOperandPill(),"number"!==this.baseCellDataType&&this.setOperand(""))),this.filterModel.type=e,this.validate()},r.prototype.setOperand=function(e){var t,r=e;this.column&&(r=null!==(t=this.advancedFilterExpressionService.getOperandModelValue(e,this.baseCellDataType,this.column))&&void 0!==t?t:""),this.filterModel.filter=r,this.validate()},r.prototype.getNumOperands=function(e){var t,r;return null!==(r=null===(t=this.advancedFilterExpressionService.getExpressionOperator(this.baseCellDataType,e))||void 0===t?void 0:t.numOperands)&&void 0!==r?r:0},r.prototype.destroyOperandPill=function(){delete this.filterModel.filter,this.getGui().removeChild(this.eOperandPill.getGui()),this.destroyBean(this.eOperandPill),this.eOperandPill=void 0},r.prototype.validate=function(){var t=null;e._.exists(this.getColumnKey())?e._.exists(this.getOperatorKey())?this.numOperands>0&&!e._.exists(this.getOperandDisplayValue())&&(t=this.advancedFilterExpressionService.translate("advancedFilterBuilderValidationEnterValue")):t=this.advancedFilterExpressionService.translate("advancedFilterBuilderValidationSelectOption"):t=this.advancedFilterExpressionService.translate("advancedFilterBuilderValidationSelectColumn"),this.item.valid=!t,t!==this.validationMessage&&(this.validationMessage=t,this.dispatchEvent({type:P.EVENT_VALID_CHANGED}))},r.prototype.getDefaultColumnDisplayValue=function(){return this.advancedFilterExpressionService.translate("advancedFilterBuilderSelectColumn")},r.prototype.getDefaultOptionSelectValue=function(){return this.advancedFilterExpressionService.translate("advancedFilterBuilderSelectOption")},D([e.Autowired("advancedFilterExpressionService")],r.prototype,"advancedFilterExpressionService",void 0),D([e.Autowired("valueParserService")],r.prototype,"valueParserService",void 0),r}(e.Component),M=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),_=function(e,t,r,i){var o,n=arguments.length,a=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(n<3?o(a):n>3?o(t,r,a):o(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a},k=function(t){function r(e){var r=t.call(this,'\n            <div class="ag-advanced-filter-builder-pill-wrapper" role="presentation">\n                <div ref="ePill" class="ag-advanced-filter-builder-pill" role="button">\n                    <span ref="eLabel" class="ag-advanced-filter-builder-pill-display"></span>\n                </div>\n            </div>\n        ')||this;return r.params=e,r.value=e.value,r}return M(r,t),r.prototype.postConstruct=function(){var t=this,r=this.params,i=r.cssClass,o=r.ariaLabel;this.ePill.classList.add(i),this.activateTabIndex([this.ePill]),this.eLabel.id="".concat(this.getCompId()),e._.setAriaDescribedBy(this.ePill,this.eLabel.id),e._.setAriaLabel(this.ePill,o),this.renderValue(),this.addManagedListener(this.ePill,"click",(function(e){e.preventDefault(),t.showEditor()})),this.addManagedListener(this.ePill,"keydown",(function(r){switch(r.key){case e.KeyCode.ENTER:r.preventDefault(),e._.stopPropagationForAgGrid(r),t.showEditor()}})),this.addDestroyFunc((function(){return t.destroyBean(t.eEditor)}))},r.prototype.getFocusableElement=function(){return this.ePill},r.prototype.showEditor=function(){var t=this;if(!this.eEditor){e._.setDisplayed(this.ePill,!1),this.eEditor=this.createEditorComp(this.params.type),this.eEditor.setValue(this.value);var r=this.eEditor.getGui();this.eEditor.addManagedListener(r,"keydown",(function(r){switch(r.key){case e.KeyCode.ENTER:r.preventDefault(),e._.stopPropagationForAgGrid(r),t.updateValue(!0);break;case e.KeyCode.ESCAPE:r.preventDefault(),e._.stopPropagationForAgGrid(r),t.hideEditor(!0)}})),this.eEditor.addManagedListener(r,"focusout",(function(){t.updateValue(!1)})),this.getGui().appendChild(r),this.eEditor.getFocusableElement().focus()}},r.prototype.createEditorComp=function(t){var r;switch(t){case"text":r=new e.AgInputTextField;break;case"number":r=new e.AgInputNumberField;break;case"date":r=new e.AgInputDateField}return this.createBean(r)},r.prototype.hideEditor=function(t){var r=this.eEditor;r&&(this.eEditor=void 0,this.getGui().removeChild(r.getGui()),this.destroyBean(r),e._.setDisplayed(this.ePill,!0),t&&this.ePill.focus())},r.prototype.renderValue=function(){var t;this.eLabel.classList.remove("ag-advanced-filter-builder-value-empty","ag-advanced-filter-builder-value-number","ag-advanced-filter-builder-value-text"),e._.exists(this.value)?"number"===this.params.type?(t=this.value,this.eLabel.classList.add("ag-advanced-filter-builder-value-number")):(t='"'.concat(this.value,'"'),this.eLabel.classList.add("ag-advanced-filter-builder-value-text")):(t=this.advancedFilterExpressionService.translate("advancedFilterBuilderEnterValue"),this.eLabel.classList.add("ag-advanced-filter-builder-value-empty")),this.eLabel.innerText=t},r.prototype.updateValue=function(t){var r;if(this.eEditor){var i=null!==(r=this.eEditor.getValue())&&void 0!==r?r:"";this.dispatchEvent({type:e.Events.EVENT_FIELD_VALUE_CHANGED,value:i}),this.value=i,this.renderValue(),this.hideEditor(t)}},_([e.RefSelector("ePill")],r.prototype,"ePill",void 0),_([e.RefSelector("eLabel")],r.prototype,"eLabel",void 0),_([e.Autowired("advancedFilterExpressionService")],r.prototype,"advancedFilterExpressionService",void 0),_([e.PostConstruct],r.prototype,"postConstruct",null),r}(e.Component),L=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),F=function(e,t,r,i){var o,n=arguments.length,a=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(n<3?o(a):n>3?o(t,r,a):o(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a},I=function(t){function r(){return t.call(this,'\n            <div class="ag-advanced-filter-builder-item-condition" role="presentation"></div>\n        ')||this}return L(r,t),r.prototype.init=function(e){var t=this,r=e.item,i=e.createPill,o=r.filterModel;this.filterModel=o,this.ePill=i({key:o.type,displayValue:this.advancedFilterExpressionService.parseJoinOperator(o),cssClass:"ag-advanced-filter-builder-join-pill",isSelect:!0,getEditorParams:function(){return{values:t.advancedFilterExpressionService.getJoinOperatorAutocompleteEntries()}},update:function(e){return o.type=e},pickerAriaLabelKey:"ariaLabelAdvancedFilterBuilderJoinSelectField",pickerAriaLabelValue:"Advanced Filter Builder Join Operator Select Field",ariaLabel:this.advancedFilterExpressionService.translate("ariaAdvancedFilterBuilderJoinOperator")}),this.getGui().appendChild(this.ePill.getGui()),this.addDestroyFunc((function(){return t.destroyBean(t.ePill)}))},r.prototype.getDragName=function(){return this.advancedFilterExpressionService.parseJoinOperator(this.filterModel)},r.prototype.getAriaLabel=function(){return"".concat(this.advancedFilterExpressionService.translate("ariaAdvancedFilterBuilderGroupItem")," ").concat(this.getDragName())},r.prototype.getValidationMessage=function(){return null},r.prototype.getFocusableElement=function(){return this.ePill.getFocusableElement()},F([e.Autowired("advancedFilterExpressionService")],r.prototype,"advancedFilterExpressionService",void 0),r}(e.Component),N=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),G=function(){return(G=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},B=function(t){function r(e){var r=t.call(this,G(G({},e),{template:'\n                <div class="ag-picker-field ag-advanced-filter-builder-pill-wrapper" role="presentation">\n                    <div ref="eLabel"></div>\n                    <div ref="eWrapper" class="ag-wrapper ag-advanced-filter-builder-pill ag-picker-collapsed">\n                        <div ref="eDisplayField" class="ag-picker-field-display ag-advanced-filter-builder-pill-display"></div>\n                        <ag-input-text-field ref="eInput" class="ag-rich-select-field-input"></ag-input-text-field>\n                        <div ref="eIcon" class="ag-picker-field-icon" aria-hidden="true"></div>\n                    </div>\n                </div>'}))||this;return r.params=e,r}return N(r,t),r.prototype.getFocusableElement=function(){return this.eWrapper},r.prototype.showPicker=function(){var e=this;setTimeout((function(){return t.prototype.showPicker.call(e)}))},r.prototype.hidePicker=function(){var e=this;setTimeout((function(){return t.prototype.hidePicker.call(e)}))},r.prototype.postConstruct=function(){t.prototype.postConstruct.call(this);var r=this.params,i=r.wrapperClassName,o=r.ariaLabel;this.eWrapper.classList.add(i),e._.setAriaLabelledBy(this.eWrapper,""),e._.setAriaLabel(this.eWrapper,o)},r.prototype.createPickerComponent=function(){var e;if(!this.values){var r=this.params.getEditorParams().values;this.values=r;var i=this.value.key,o=null!==(e=r.find((function(e){return e.key===i})))&&void 0!==e?e:{key:i,displayValue:this.value.displayValue};this.value=o}return t.prototype.createPickerComponent.call(this)},r.prototype.onEnterKeyDown=function(r){e._.stopPropagationForAgGrid(r),this.isPickerDisplayed?t.prototype.onEnterKeyDown.call(this,r):(r.preventDefault(),this.showPicker())},r}(e.AgRichSelect),V=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),j=function(e,t,r,i){var o,n=arguments.length,a=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(n<3?o(a):n>3?o(t,r,a):o(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a},U=function(t){function r(e,r,i){var o=t.call(this,'\n            <div class="ag-advanced-filter-builder-item-wrapper" role="presentation">\n                <div ref="eItem" class="ag-advanced-filter-builder-item" role="presentation">\n                    <div ref="eTreeLines" class="ag-advanced-filter-builder-item-tree-lines" aria-hidden="true"></div>\n                    <span ref="eDragHandle" class="ag-drag-handle" aria-hidden="true"></span>\n                    <span ref="eValidation" class="ag-advanced-filter-builder-item-button ag-advanced-filter-builder-invalid" aria-hidden="true"></span>\n                </div>\n                <div ref="eButtons" class="ag-advanced-filter-builder-item-buttons">\n                    <span ref="eMoveUpButton" class="ag-advanced-filter-builder-item-button" role="button"></span>\n                    <span ref="eMoveDownButton" class="ag-advanced-filter-builder-item-button" role="button"></span>\n                    <div ref="eAddButton" role="presentation"></div>\n                    <span ref="eRemoveButton" class="ag-advanced-filter-builder-item-button" role="button"></span>\n                </div>\n            </div>\n        ')||this;return o.item=e,o.dragFeature=r,o.focusWrapper=i,o.moveUpDisabled=!1,o.moveDownDisabled=!1,o}return V(r,t),r.prototype.postConstruct=function(){var t=this,r=this.item,i=r.filterModel,o=r.level,n=r.showMove,a="join"===i.filterType;if(this.ePillWrapper=this.createManagedBean(a?new I:new R),this.ePillWrapper.init({item:this.item,createPill:function(e){return t.createPill(e)}}),this.eDragHandle.insertAdjacentElement("afterend",this.ePillWrapper.getGui()),0===o){var s=document.createElement("div");s.classList.add("ag-advanced-filter-builder-item-tree-line-vertical-bottom"),s.classList.add("ag-advanced-filter-builder-item-tree-line-root"),this.eTreeLines.appendChild(s),e._.setDisplayed(this.eDragHandle,!1),e._.setDisplayed(this.eButtons,!1),e._.setAriaExpanded(this.focusWrapper,!0)}else this.setupTreeLines(o),this.eDragHandle.appendChild(e._.createIconNoSpan("advancedFilterBuilderDrag",this.gridOptionsService)),this.setupValidation(),this.setupMoveButtons(n),this.setupAddButton(),this.setupRemoveButton(),this.setupDragging(),this.updateAriaExpanded();e._.setAriaLevel(this.focusWrapper,o+1),this.initialiseTabGuard({}),this.createManagedBean(new A(this.getGui(),this.focusWrapper,this.ePillWrapper)),this.updateAriaLabel(),this.addManagedListener(this.ePillWrapper,P.EVENT_VALUE_CHANGED,(function(){return t.dispatchEvent({type:P.EVENT_VALUE_CHANGED})})),this.addManagedListener(this.ePillWrapper,P.EVENT_VALID_CHANGED,(function(){return t.updateValidity()}))},r.prototype.setState=function(t){if(0!==this.item.level){var r=this.item.showMove,i=t.disableMoveUp,o=t.disableMoveDown,n=t.treeLines,a=t.showStartTreeLine;this.updateTreeLines(n,a),this.updateAriaExpanded(),r&&(this.moveUpDisabled=!!i,this.moveDownDisabled=!!o,this.eMoveUpButton.classList.toggle("ag-advanced-filter-builder-item-button-disabled",i),this.eMoveDownButton.classList.toggle("ag-advanced-filter-builder-item-button-disabled",o),e._.setAriaDisabled(this.eMoveUpButton,!!i),e._.setAriaDisabled(this.eMoveDownButton,!!o),this.moveUpTooltipFeature.refreshToolTip(),this.moveDownTooltipFeature.refreshToolTip())}},r.prototype.focusMoveButton=function(e){(e?this.eMoveUpButton:this.eMoveDownButton).focus()},r.prototype.afterAdd=function(){this.ePillWrapper.getFocusableElement().focus()},r.prototype.setupTreeLines=function(e){for(var t=0;t<e;t++){var r=document.createElement("div");this.eTreeLines.appendChild(r)}},r.prototype.updateTreeLines=function(e,t){for(var r=e.length-1,i=this.eTreeLines.children,o=0;o<r;o++){var n=i.item(o);n&&n.classList.toggle("ag-advanced-filter-builder-item-tree-line-vertical",!e[o])}var a=i.item(r);if(a){a.classList.add("ag-advanced-filter-builder-item-tree-line-horizontal");var s=e[r];a.classList.toggle("ag-advanced-filter-builder-item-tree-line-vertical-top",s),a.classList.toggle("ag-advanced-filter-builder-item-tree-line-vertical",!s)}this.eDragHandle.classList.toggle("ag-advanced-filter-builder-item-tree-line-vertical-bottom",t)},r.prototype.setupValidation=function(){var t=this;this.eValidation.appendChild(e._.createIconNoSpan("advancedFilterBuilderInvalid",this.gridOptionsService)),this.validationTooltipFeature=this.createManagedBean(new e.TooltipFeature({getGui:function(){return t.eValidation},getLocation:function(){return"advancedFilter"},getTooltipValue:function(){return t.ePillWrapper.getValidationMessage()},getTooltipShowDelayOverride:function(){return 1e3}},this.beans)),this.validationTooltipFeature.setComp(this.eValidation),this.updateValidity()},r.prototype.setupAddButton=function(){var t,r=this,i=O((function(e){return r.advancedFilterExpressionService.translate(e)}),null===(t=this.gridOptionsService.get("advancedFilterBuilderParams"))||void 0===t?void 0:t.addSelectWidth),o=this.createManagedBean(new C(i));this.addManagedListener(o,e.Events.EVENT_FIELD_PICKER_VALUE_SELECTED,(function(e){var t=e.value;return r.dispatchEvent({type:P.EVENT_ADDED,item:r.item,isJoin:"join"===t.key})})),this.eAddButton.appendChild(o.getGui()),this.createManagedBean(new e.TooltipFeature({getGui:function(){return r.eAddButton},getLocation:function(){return"advancedFilter"},getTooltipValue:function(){return r.advancedFilterExpressionService.translate("advancedFilterBuilderAddButtonTooltip")}},this.beans)).setComp(this.eAddButton)},r.prototype.setupRemoveButton=function(){var t=this;this.eRemoveButton.appendChild(e._.createIconNoSpan("advancedFilterBuilderRemove",this.gridOptionsService)),this.addManagedListener(this.eRemoveButton,"click",(function(){return t.removeItem()})),this.addManagedListener(this.eRemoveButton,"keydown",(function(r){switch(r.key){case e.KeyCode.ENTER:r.preventDefault(),e._.stopPropagationForAgGrid(r),t.removeItem()}})),this.createManagedBean(new e.TooltipFeature({getGui:function(){return t.eRemoveButton},getLocation:function(){return"advancedFilter"},getTooltipValue:function(){return t.advancedFilterExpressionService.translate("advancedFilterBuilderRemoveButtonTooltip")}},this.beans)).setComp(this.eRemoveButton),e._.setAriaLabel(this.eRemoveButton,this.advancedFilterExpressionService.translate("advancedFilterBuilderRemoveButtonTooltip")),this.activateTabIndex([this.eRemoveButton])},r.prototype.setupMoveButtons=function(t){var r=this;t?(this.eMoveUpButton.appendChild(e._.createIconNoSpan("advancedFilterBuilderMoveUp",this.gridOptionsService)),this.addManagedListener(this.eMoveUpButton,"click",(function(){return r.moveItem(!0)})),this.addManagedListener(this.eMoveUpButton,"keydown",(function(t){switch(t.key){case e.KeyCode.ENTER:t.preventDefault(),e._.stopPropagationForAgGrid(t),r.moveItem(!0)}})),this.moveUpTooltipFeature=this.createManagedBean(new e.TooltipFeature({getGui:function(){return r.eMoveUpButton},getLocation:function(){return"advancedFilter"},getTooltipValue:function(){return r.moveUpDisabled?null:r.advancedFilterExpressionService.translate("advancedFilterBuilderMoveUpButtonTooltip")}},this.beans)),this.moveUpTooltipFeature.setComp(this.eMoveUpButton),e._.setAriaLabel(this.eMoveUpButton,this.advancedFilterExpressionService.translate("advancedFilterBuilderMoveUpButtonTooltip")),this.eMoveDownButton.appendChild(e._.createIconNoSpan("advancedFilterBuilderMoveDown",this.gridOptionsService)),this.addManagedListener(this.eMoveDownButton,"click",(function(){return r.moveItem(!1)})),this.addManagedListener(this.eMoveDownButton,"keydown",(function(t){switch(t.key){case e.KeyCode.ENTER:t.preventDefault(),e._.stopPropagationForAgGrid(t),r.moveItem(!1)}})),this.moveDownTooltipFeature=this.createManagedBean(new e.TooltipFeature({getGui:function(){return r.eMoveDownButton},getLocation:function(){return"advancedFilter"},getTooltipValue:function(){return r.moveDownDisabled?null:r.advancedFilterExpressionService.translate("advancedFilterBuilderMoveDownButtonTooltip")}},this.beans)),this.moveDownTooltipFeature.setComp(this.eMoveDownButton),e._.setAriaLabel(this.eMoveDownButton,this.advancedFilterExpressionService.translate("advancedFilterBuilderMoveDownButtonTooltip")),this.activateTabIndex([this.eMoveUpButton,this.eMoveDownButton])):(e._.setDisplayed(this.eMoveUpButton,!1),e._.setDisplayed(this.eMoveDownButton,!1))},r.prototype.updateValidity=function(){e._.setVisible(this.eValidation,!this.item.valid),this.validationTooltipFeature.refreshToolTip(),this.updateAriaLabel()},r.prototype.createPill=function(t){var r,i,o=this,n=t.key,a=t.displayValue,s=t.cssClass,l=t.update,c=t.ariaLabel,u=function(e){null!=e&&(l(e),o.dispatchEvent({type:P.EVENT_VALUE_CHANGED}))};if(t.isSelect){var d=t.getEditorParams,p=t.pickerAriaLabelKey,h=t.pickerAriaLabelValue,f=this.gridOptionsService.get("advancedFilterBuilderParams"),g="".concat(null!==(r=null==f?void 0:f.pillSelectMinWidth)&&void 0!==r?r:140,"px"),y="".concat(null!==(i=null==f?void 0:f.pillSelectMaxWidth)&&void 0!==i?i:200,"px"),v=this.createBean(new B({pickerAriaLabelKey:p,pickerAriaLabelValue:h,pickerType:"ag-list",value:{key:n,displayValue:a},valueFormatter:function(e){var t;return null==e?null:null!==(t=e.displayValue)&&void 0!==t?t:e.key},variableWidth:!0,minPickerWidth:g,maxPickerWidth:y,getEditorParams:d,wrapperClassName:s,ariaLabel:c}));return this.addManagedListener(v,e.Events.EVENT_FIELD_PICKER_VALUE_SELECTED,(function(e){var t=e.value;return u(null==t?void 0:t.key)})),v}v=this.createBean(new k({value:a,cssClass:s,type:this.getInputType(t.baseCellDataType),ariaLabel:c}));return this.addManagedListener(v,e.Events.EVENT_FIELD_VALUE_CHANGED,(function(e){var t=e.value;return u(t)})),v},r.prototype.getInputType=function(e){switch(e){case"text":case"object":case"boolean":return"text";case"number":return"number";case"date":case"dateString":return"date"}},r.prototype.setupDragging=function(){var t=this,r={type:e.DragSourceType.AdvancedFilterBuilder,eElement:this.eDragHandle,dragItemName:function(){return t.ePillWrapper.getDragName()},getDefaultIconName:function(){return e.DragAndDropService.ICON_NOT_ALLOWED},getDragItem:function(){return{}},onDragStarted:function(){return t.dragFeature.dispatchEvent({type:x.EVENT_DRAG_STARTED,item:t.item})},onDragStopped:function(){return t.dragFeature.dispatchEvent({type:x.EVENT_DRAG_ENDED})}};this.dragAndDropService.addDragSource(r,!0),this.addDestroyFunc((function(){return t.dragAndDropService.removeDragSource(r)}))},r.prototype.updateAriaLabel=function(){var t,r=this.ePillWrapper.getAriaLabel(),i="".concat(this.item.level+1),o=this.ePillWrapper.getValidationMessage();t=o?this.advancedFilterExpressionService.translate("ariaAdvancedFilterBuilderItemValidation",[r,i,o]):this.advancedFilterExpressionService.translate("ariaAdvancedFilterBuilderItem",[r,i]),e._.setAriaLabel(this.focusWrapper,t)},r.prototype.updateAriaExpanded=function(){e._.removeAriaExpanded(this.focusWrapper);var t=this.item.filterModel;"join"===(null==t?void 0:t.filterType)&&t.conditions.length&&e._.setAriaExpanded(this.focusWrapper,!0)},r.prototype.removeItem=function(){this.dispatchEvent({type:P.EVENT_REMOVED,item:this.item})},r.prototype.moveItem=function(e){this.dispatchEvent({type:P.EVENT_MOVED,item:this.item,backwards:e})},j([e.RefSelector("eTreeLines")],r.prototype,"eTreeLines",void 0),j([e.RefSelector("eDragHandle")],r.prototype,"eDragHandle",void 0),j([e.RefSelector("eItem")],r.prototype,"eItem",void 0),j([e.RefSelector("eButtons")],r.prototype,"eButtons",void 0),j([e.RefSelector("eValidation")],r.prototype,"eValidation",void 0),j([e.RefSelector("eMoveUpButton")],r.prototype,"eMoveUpButton",void 0),j([e.RefSelector("eMoveDownButton")],r.prototype,"eMoveDownButton",void 0),j([e.RefSelector("eAddButton")],r.prototype,"eAddButton",void 0),j([e.RefSelector("eRemoveButton")],r.prototype,"eRemoveButton",void 0),j([e.Autowired("beans")],r.prototype,"beans",void 0),j([e.Autowired("dragAndDropService")],r.prototype,"dragAndDropService",void 0),j([e.Autowired("advancedFilterExpressionService")],r.prototype,"advancedFilterExpressionService",void 0),j([e.PostConstruct],r.prototype,"postConstruct",null),r}(e.TabGuardComp),H=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),W=function(e,t,r,i){var o,n=arguments.length,a=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(n<3?o(a):n>3?o(t,r,a):o(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a},z=function(t){function r(e,r){var i=t.call(this,'\n            <div class="ag-advanced-filter-builder-item-wrapper" role="presentation">\n                <div ref="eItem" class="ag-advanced-filter-builder-item" role="presentation">\n                    <div class="ag-advanced-filter-builder-item-tree-lines" aria-hidden="true">\n                        <div class="ag-advanced-filter-builder-item-tree-line-vertical-top ag-advanced-filter-builder-item-tree-line-horizontal"></div>\n                    </div>\n                </div>\n            </div>\n        ')||this;return i.item=e,i.focusWrapper=r,i}return H(r,t),r.prototype.postConstruct=function(){var t,r=this;e._.setAriaLevel(this.focusWrapper,2);var i=O((function(e){return r.advancedFilterExpressionService.translate(e)}),null===(t=this.gridOptionsService.get("advancedFilterBuilderParams"))||void 0===t?void 0:t.addSelectWidth),o=this.createManagedBean(new C(i));this.addManagedListener(o,e.Events.EVENT_FIELD_PICKER_VALUE_SELECTED,(function(e){var t=e.value;r.dispatchEvent({type:P.EVENT_ADDED,item:r.item,isJoin:"join"===t.key})})),this.eItem.appendChild(o.getGui()),this.createManagedBean(new e.TooltipFeature({getGui:function(){return o.getGui()},getLocation:function(){return"advancedFilter"},getTooltipValue:function(){return r.advancedFilterExpressionService.translate("advancedFilterBuilderAddButtonTooltip")}},this.beans)).setComp(o.getGui()),this.createManagedBean(new A(this.getGui(),this.focusWrapper,o)),e._.setAriaLabel(this.focusWrapper,this.advancedFilterExpressionService.translate("ariaAdvancedFilterBuilderItem",[this.advancedFilterExpressionService.translate("advancedFilterBuilderAddButtonTooltip"),"".concat(this.item.level+1)]))},r.prototype.afterAdd=function(){},W([e.Autowired("beans")],r.prototype,"beans",void 0),W([e.Autowired("advancedFilterExpressionService")],r.prototype,"advancedFilterExpressionService",void 0),W([e.RefSelector("eItem")],r.prototype,"eItem",void 0),W([e.PostConstruct],r.prototype,"postConstruct",null),r}(e.Component),K=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Y=function(e,t,r,i){var o,n=arguments.length,a=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(n<3?o(a):n>3?o(t,r,a):o(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a},X=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,o,n=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(e){o={error:e}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a},q=function(e,t,r){if(r||2===arguments.length)for(var i,o=0,n=t.length;o<n;o++)!i&&o in t||(i||(i=Array.prototype.slice.call(t,0,o)),i[o]=t[o]);return e.concat(i||Array.prototype.slice.call(t))},$=function(t){function r(){var e=t.call(this,'\n            <div role="presentation" class="ag-advanced-filter-builder" tabindex="-1">\n                <div role="presentation" class="ag-advanced-filter-builder-list" ref="eList"></div>\n                <div role="presentation" class="ag-advanced-filter-builder-button-panel">\n                    <button class="ag-button ag-standard-button ag-advanced-filter-builder-apply-button" ref="eApplyFilterButton"></button>\n                    <button class="ag-button ag-standard-button ag-advanced-filter-builder-cancel-button" ref="eCancelFilterButton"></button>\n                </div>\n            </div>')||this;return e.validationMessage=null,e}return K(r,t),r.prototype.postConstruct=function(){var e,t=this,r=(null!==(e=this.gridOptionsService.get("advancedFilterBuilderParams"))&&void 0!==e?e:{}).showMoveButtons;this.showMove=!!r,this.addManagedPropertyListener("advancedFilterBuilderParams",(function(e){var r=e.currentValue;t.showMove=!!(null==r?void 0:r.showMoveButtons),t.refreshList(!1)})),this.filterModel=this.setupFilterModel(),this.setupVirtualList(),this.dragFeature=this.createManagedBean(new x(this,this.virtualList)),this.setupButtons()},r.prototype.refresh=function(){var e=this.virtualList.getLastFocusedRow();this.setupFilterModel(),this.validateItems(),this.refreshList(!1),null!=e&&(this.virtualList.getComponentAt(e)||(e=0),this.virtualList.focusRow(e))},r.prototype.getNumItems=function(){return this.items.length},r.prototype.moveItem=function(e,t){t&&e&&this.moveItemToIndex(e,t.rowIndex,t.position)},r.prototype.afterGuiAttached=function(){this.virtualList.focusRow(0)},r.prototype.setupVirtualList=function(){var t=this;this.virtualList=this.createManagedBean(new e.VirtualList({cssIdentifier:"advanced-filter-builder",ariaRole:"tree",listName:this.advancedFilterExpressionService.translate("ariaAdvancedFilterBuilderList")})),this.virtualList.setComponentCreator(this.createItemComponent.bind(this)),this.virtualList.setComponentUpdater(this.updateItemComponent.bind(this)),this.virtualList.setRowHeight(40),this.eList.appendChild(this.virtualList.getGui()),this.virtualList.setModel({getRowCount:function(){return t.items.length},getRow:function(e){return t.items[e]},areRowsEqual:function(e,t){return e===t}}),this.buildList(),this.virtualList.refresh()},r.prototype.setupButtons=function(){var t=this;this.eApplyFilterButton.innerText=this.advancedFilterExpressionService.translate("advancedFilterBuilderApply"),this.activateTabIndex([this.eApplyFilterButton]),this.addManagedListener(this.eApplyFilterButton,"click",(function(){t.advancedFilterService.setModel(t.filterModel),t.filterManager.onFilterChanged({source:"advancedFilter"}),t.close()})),this.validationTooltipFeature=this.createManagedBean(new e.TooltipFeature({getGui:function(){return t.eApplyFilterButton},getLocation:function(){return"advancedFilter"},getTooltipValue:function(){return t.validationMessage},getTooltipShowDelayOverride:function(){return 1e3}},this.beans)),this.validationTooltipFeature.setComp(this.eApplyFilterButton),this.validate(),this.addManagedListener(this.eApplyFilterButton,"mouseenter",(function(){return t.addOrRemoveCssClass("ag-advanced-filter-builder-validation",!0)})),this.addManagedListener(this.eApplyFilterButton,"mouseleave",(function(){return t.addOrRemoveCssClass("ag-advanced-filter-builder-validation",!1)})),this.eCancelFilterButton.innerText=this.advancedFilterExpressionService.translate("advancedFilterBuilderCancel"),this.activateTabIndex([this.eCancelFilterButton]),this.addManagedListener(this.eCancelFilterButton,"click",(function(){return t.close()}))},r.prototype.removeItemFromParent=function(e){var t=e.parent.conditions.indexOf(e.filterModel);return e.parent.conditions.splice(t,1),t},r.prototype.moveItemToIndex=function(e,t,r){var i,o,n=this.items[t],a="join"===(null===(i=n.filterModel)||void 0===i?void 0:i.filterType)&&"bottom"===r,s=a?n.filterModel:n.parent;s&&(this.isChildOrSelf(s,e.filterModel)||n===e||(this.removeItemFromParent(e),a?o=0:-1===(o=s.conditions.indexOf(n.filterModel))?o=s.conditions.length:"bottom"===r&&(o+=1),s.conditions.splice(o,0,e.filterModel),this.refreshList(!1)))},r.prototype.isChildOrSelf=function(e,t){var r=this;return e===t||"join"===t.filterType&&t.conditions.some((function(t){return r.isChildOrSelf(e,t)}))},r.prototype.setupFilterModel=function(){var e=this.formatFilterModel(this.advancedFilterService.getModel());return this.stringifiedModel=JSON.stringify(e),e},r.prototype.formatFilterModel=function(e){return"join"!==(e=null!=e?e:{filterType:"join",type:"AND",conditions:[]}).filterType&&(e={filterType:"join",type:"AND",conditions:[e]}),e},r.prototype.buildList=function(){var e=this,t=function(r,i,o,n){i.push({filterModel:r,level:o,parent:n,valid:!0,showMove:e.showMove}),"join"===r.filterType&&(r.conditions.forEach((function(e){return t(e,i,o+1,r)})),0===o&&i.push({filterModel:null,level:o+1,parent:r,valid:!0}))};this.items=[],t(this.filterModel,this.items,0)},r.prototype.refreshList=function(e){if(!e){var t=[];this.items.forEach((function(e){e.valid||t.push(e.filterModel)})),this.buildList(),t.length&&this.items.forEach((function(e){e.filterModel&&t.includes(e.filterModel)&&(e.valid=!1)}))}this.virtualList.refresh(e),this.validate()},r.prototype.updateItemComponent=function(e,t){var r=this,i=this.items.indexOf(e),o=function(e,t){var i=r.items.find((function(t){return t.filterModel===e})),n=null==i?void 0:i.parent;if(n){var a=n.conditions;o(n,t),t.push(a[a.length-1]===e)}},n=[],a=e.filterModel;a&&(o(a,n),n[0]=!1);var s="join"===(null==a?void 0:a.filterType)&&!!a.conditions.length;t.setState({disableMoveUp:1===i,disableMoveDown:!this.canMoveDown(e,i),treeLines:n,showStartTreeLine:s})},r.prototype.createItemComponent=function(e,t){var r=this,i=this.createBean(e.filterModel?new U(e,this.dragFeature,t):new z(e,t));return i.addManagedListener(i,P.EVENT_REMOVED,(function(e){var t=e.item;return r.removeItem(t)})),i.addManagedListener(i,P.EVENT_VALUE_CHANGED,(function(){return r.validate()})),i.addManagedListener(i,P.EVENT_ADDED,(function(e){var t=e.item,i=e.isJoin;return r.addItem(t,i)})),i.addManagedListener(i,P.EVENT_MOVED,(function(e){var t=e.item,i=e.backwards;return r.moveItemUpDown(t,i)})),i instanceof U&&this.updateItemComponent(e,i),i},r.prototype.addItem=function(e,t){var r,i,o=e.parent,n=e.level,a=e.filterModel,s="join"===(null==a?void 0:a.filterType),l=t?{filterType:"join",type:"AND",conditions:[]}:{},c=s?a:o,u=s?0:c.conditions.indexOf(a);u>=0?(s||(u+=1),c.conditions.splice(u,0,l)):c.conditions.push(l);var d=this.items.indexOf(e),p=d>=0;if(p){e.filterModel&&d++;var h=[{filterModel:l,level:s?n+1:n,parent:c,valid:t,showMove:this.showMove}];(r=this.items).splice.apply(r,q([d,0],X(h),!1))}this.refreshList(p),p&&(null===(i=this.virtualList.getComponentAt(d))||void 0===i||i.afterAdd())},r.prototype.removeItem=function(e){var t,r=e.parent,i=e.filterModel,o=r.conditions.indexOf(i);r.conditions.splice(o,1);var n="join"===(null===(t=e.filterModel)||void 0===t?void 0:t.filterType),a=this.items.indexOf(e),s=!n&&a>=0;s&&this.items.splice(a,1),this.refreshList(s),a>=0&&this.virtualList.focusRow(a)},r.prototype.moveItemUpDown=function(e,t){var r=this.items.indexOf(e),i=t?r-1:r+1;if(0!==i&&(t||this.canMoveDown(e,r))){var o=this.items[i],n=this.removeItemFromParent(e),a=e.level,s=e.filterModel,l=e.parent,c=o.level,u=o.filterModel,d=o.parent;if(t)if(c===a&&"join"===u.filterType)u.conditions.push(s);else if(c<=a){var p=d.conditions.indexOf(u);d.conditions.splice(p,0,s)}else{l.conditions[n-1].conditions.push(s)}else if(c===a)if("join"===u.filterType)u.conditions.splice(0,0,s);else{var h=d.conditions.indexOf(u);d.conditions.splice(h+1,0,s)}else if(n<l.conditions.length)l.conditions.splice(n+1,0,s);else{var f=this.items.find((function(e){return e.filterModel===l})),g=f.parent.conditions.indexOf(f.filterModel)+1;f.parent.conditions.splice(g,0,s)}this.refreshList(!1);var y=this.items.findIndex((function(e){return e.filterModel===s}));if(y>=0){var v=this.virtualList.getComponentAt(y);v instanceof U&&v.focusMoveButton(t)}}},r.prototype.canMoveDown=function(e,t){return!(1===e.level&&t===this.items.length-2||1===e.level&&e.parent.conditions[e.parent.conditions.length-1]===e.filterModel)},r.prototype.close=function(){this.advancedFilterService.getCtrl().toggleFilterBuilder("ui")},r.prototype.validate=function(){var t=!this.items.every((function(e){return e.valid}));t?this.validationMessage=this.advancedFilterExpressionService.translate("advancedFilterBuilderValidationIncomplete"):(t=JSON.stringify(this.filterModel)===this.stringifiedModel,this.validationMessage=t?this.advancedFilterExpressionService.translate("advancedFilterBuilderValidationAlreadyApplied"):null),e._.setDisabled(this.eApplyFilterButton,t),this.validationTooltipFeature.refreshToolTip()},r.prototype.validateItems=function(){var t=this,r=function(e){e.type=void 0},i=function(e){delete e.filter};this.items.forEach((function(o){if(o.valid&&o.filterModel&&"join"!==o.filterModel.filterType){var n=o.filterModel,a=n.colId,s=t.advancedFilterExpressionService.getColumnAutocompleteEntries().find((function(e){return e.key===a})),l=t.advancedFilterExpressionService.getColumnDetails(n.colId);if(!s||!l.column)return o.valid=!1,n.colId=void 0,r(n),void i(n);var c=t.advancedFilterExpressionService.getDataTypeExpressionOperator(l.baseCellDataType).operators[n.type];if(!c)return o.valid=!1,r(n),void i(n);c.numOperands>0&&!e._.exists(n.filter)&&(o.valid=!1)}}))},Y([e.RefSelector("eList")],r.prototype,"eList",void 0),Y([e.RefSelector("eApplyFilterButton")],r.prototype,"eApplyFilterButton",void 0),Y([e.RefSelector("eCancelFilterButton")],r.prototype,"eCancelFilterButton",void 0),Y([e.Autowired("filterManager")],r.prototype,"filterManager",void 0),Y([e.Autowired("advancedFilterService")],r.prototype,"advancedFilterService",void 0),Y([e.Autowired("advancedFilterExpressionService")],r.prototype,"advancedFilterExpressionService",void 0),Y([e.Autowired("beans")],r.prototype,"beans",void 0),Y([e.PostConstruct],r.prototype,"postConstruct",null),r}(e.Component),Z=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),J=function(e,t,r,i){var o,n=arguments.length,a=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(n<3?o(a):n>3?o(t,r,a):o(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a},Q=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,o,n=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(e){o={error:e}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a},ee=function(e,t,r){if(r||2===arguments.length)for(var i,o=0,n=t.length;o<n;o++)!i&&o in t||(i||(i=Array.prototype.slice.call(t,0,o)),i[o]=t[o]);return e.concat(i||Array.prototype.slice.call(t))},te=function(t){function r(e){var r=t.call(this)||this;return r.enabled=e,r}return Z(r,t),r.prototype.postConstruct=function(){var t=this;this.hasAdvancedFilterParent=!!this.gridOptionsService.get("advancedFilterParent"),this.ctrlsService.whenReady((function(){return t.setAdvancedFilterComp()})),this.addManagedListener(this.eventService,e.Events.EVENT_ADVANCED_FILTER_ENABLED_CHANGED,(function(e){var r=e.enabled;return t.onEnabledChanged(r)})),this.addManagedPropertyListener("advancedFilterParent",(function(){return t.updateComps()})),this.addDestroyFunc((function(){t.destroyAdvancedFilterComp(),t.destroyBean(t.eBuilderComp),t.eBuilderDialog&&t.eBuilderDialog.isAlive()&&t.destroyBean(t.eBuilderDialog)}))},r.prototype.setupHeaderComp=function(e){this.eHeaderComp=this.createManagedBean(new y(this.enabled&&!this.hasAdvancedFilterParent)),e.insertAdjacentElement("beforebegin",this.eHeaderComp.getGui())},r.prototype.focusHeaderComp=function(){return!!this.eHeaderComp&&(this.eHeaderComp.getFocusableElement().focus(),!0)},r.prototype.refreshComp=function(){var e,t;null===(e=this.eFilterComp)||void 0===e||e.refresh(),null===(t=this.eHeaderComp)||void 0===t||t.refresh()},r.prototype.refreshBuilderComp=function(){var e;null===(e=this.eBuilderComp)||void 0===e||e.refresh()},r.prototype.getHeaderHeight=function(){var e,t;return null!==(t=null===(e=this.eHeaderComp)||void 0===e?void 0:e.getHeight())&&void 0!==t?t:0},r.prototype.setInputDisabled=function(e){var t,r;null===(t=this.eFilterComp)||void 0===t||t.setInputDisabled(e),null===(r=this.eHeaderComp)||void 0===r||r.setInputDisabled(e)},r.prototype.toggleFilterBuilder=function(t,i){var o=this;if(!(i&&this.eBuilderDialog||!1===i&&!this.eBuilderDialog)){if(this.eBuilderDialog)return this.builderDestroySource=t,void this.destroyBean(this.eBuilderDialog);this.setInputDisabled(!0);var n=this.getBuilderDialogSize(),a=n.width,s=n.height,l=n.minWidth;this.eBuilderComp=this.createBean(new $),this.eBuilderDialog=this.createBean(new e.AgDialog({title:this.advancedFilterExpressionService.translate("advancedFilterBuilderTitle"),component:this.eBuilderComp,width:a,height:s,resizable:!0,movable:!0,maximizable:!0,centered:!0,closable:!0,minWidth:l,afterGuiAttached:function(){var e;return null===(e=o.eBuilderComp)||void 0===e?void 0:e.afterGuiAttached()}})),this.dispatchFilterBuilderVisibleChangedEvent(t,!0),this.eBuilderDialog.addEventListener(e.AgDialog.EVENT_DESTROYED,(function(){var e;o.destroyBean(o.eBuilderComp),o.eBuilderComp=void 0,o.eBuilderDialog=void 0,o.setInputDisabled(!1),o.dispatchEvent({type:r.EVENT_BUILDER_CLOSED}),o.dispatchFilterBuilderVisibleChangedEvent(null!==(e=o.builderDestroySource)&&void 0!==e?e:"ui",!1),o.builderDestroySource=void 0}))}},r.prototype.dispatchFilterBuilderVisibleChangedEvent=function(t,r){var i={type:e.Events.EVENT_ADVANCED_FILTER_BUILDER_VISIBLE_CHANGED,source:t,visible:r};this.eventService.dispatchEvent(i)},r.prototype.getBuilderDialogSize=function(){var t,r,i=null!==(r=null===(t=this.gridOptionsService.get("advancedFilterBuilderParams"))||void 0===t?void 0:t.minWidth)&&void 0!==r?r:500,o=this.popupService.getPopupParent(),n=Math.round(e._.getAbsoluteWidth(o))-2,a=Math.round(.75*e._.getAbsoluteHeight(o))-2;return{width:Math.min(Math.max(600,i),n),height:Math.min(600,a),minWidth:i}},r.prototype.onEnabledChanged=function(e){this.enabled=e,this.updateComps()},r.prototype.updateComps=function(){this.setAdvancedFilterComp(),this.setHeaderCompEnabled(),this.eventService.dispatchEvent({type:e.Events.EVENT_HEADER_HEIGHT_CHANGED})},r.prototype.setAdvancedFilterComp=function(){var e;if(this.destroyAdvancedFilterComp(),this.enabled){var t=this.gridOptionsService.get("advancedFilterParent");if(this.hasAdvancedFilterParent=!!t,t){var r=this.createBean(new oe),i=r.getGui(),o=this.environment.getTheme().allThemes;o.length&&(e=i.classList).add.apply(e,ee([],Q(o),!1)),i.classList.add(this.gridOptionsService.get("enableRtl")?"ag-rtl":"ag-ltr"),t.appendChild(i),this.eFilterComp=r}}},r.prototype.setHeaderCompEnabled=function(){var e;null===(e=this.eHeaderComp)||void 0===e||e.setEnabled(this.enabled&&!this.hasAdvancedFilterParent)},r.prototype.destroyAdvancedFilterComp=function(){this.eFilterComp&&(e._.removeFromParent(this.eFilterComp.getGui()),this.destroyBean(this.eFilterComp))},r.EVENT_BUILDER_CLOSED="advancedFilterBuilderClosed",J([e.Autowired("focusService")],r.prototype,"focusService",void 0),J([e.Autowired("ctrlsService")],r.prototype,"ctrlsService",void 0),J([e.Autowired("popupService")],r.prototype,"popupService",void 0),J([e.Autowired("advancedFilterExpressionService")],r.prototype,"advancedFilterExpressionService",void 0),J([e.PostConstruct],r.prototype,"postConstruct",null),r}(e.BeanStub),re=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),ie=function(e,t,r,i){var o,n=arguments.length,a=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(n<3?o(a):n>3?o(t,r,a):o(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a},oe=function(t){function r(){var e=t.call(this,'\n            <div class="ag-advanced-filter" role="presentation" tabindex="-1">\n                <ag-autocomplete ref="eAutocomplete"></ag-autocomplete>\n                <button class="ag-button ag-standard-button ag-advanced-filter-apply-button" ref="eApplyFilterButton"></button>\n                <button class="ag-advanced-filter-builder-button" ref="eBuilderFilterButton">\n                    <span ref="eBuilderFilterButtonIcon" aria-hidden="true"></span>\n                    <span class="ag-advanced-filter-builder-button-label" ref="eBuilderFilterButtonLabel"></span>\n                </button>\n            </div>')||this;return e.expressionParser=null,e.isApplyDisabled=!0,e.builderOpen=!1,e}return re(r,t),r.prototype.postConstruct=function(){var t=this;this.eAutocomplete.setListGenerator((function(e,r){return t.generateAutocompleteListParams(r)})).setValidator((function(){return t.validateValue()})).setForceLastSelection((function(e,r){return t.forceLastSelection(e,r)})).setInputAriaLabel(this.advancedFilterExpressionService.translate("ariaAdvancedFilterInput")).setListAriaLabel(this.advancedFilterExpressionService.translate("ariaLabelAdvancedFilterAutocomplete")),this.refresh(),this.addManagedListener(this.eAutocomplete,e.AgAutocomplete.EVENT_VALUE_CHANGED,(function(e){var r=e.value;return t.onValueChanged(r)})),this.addManagedListener(this.eAutocomplete,e.AgAutocomplete.EVENT_VALUE_CONFIRMED,(function(e){var r=e.isValid;return t.onValueConfirmed(r)})),this.addManagedListener(this.eAutocomplete,e.AgAutocomplete.EVENT_OPTION_SELECTED,(function(e){var r=e.position,i=e.updateEntry,o=e.autocompleteType;return t.onOptionSelected(r,i,o)})),this.addManagedListener(this.eAutocomplete,e.AgAutocomplete.EVENT_VALID_CHANGED,(function(e){var r=e.isValid,i=e.validationMessage;return t.onValidChanged(r,i)})),this.setupApplyButton(),this.setupBuilderButton()},r.prototype.refresh=function(){var e=this.advancedFilterService.getExpressionDisplayValue();this.eAutocomplete.setValue({value:null!=e?e:"",position:null==e?void 0:e.length,updateListOnlyIfOpen:!0})},r.prototype.setInputDisabled=function(t){this.eAutocomplete.setInputDisabled(t),e._.setDisabled(this.eApplyFilterButton,t||this.isApplyDisabled)},r.prototype.getTooltipParams=function(){var e=t.prototype.getTooltipParams.call(this);return e.location="advancedFilter",e},r.prototype.setupApplyButton=function(){var t=this;this.eApplyFilterButton.innerText=this.advancedFilterExpressionService.translate("advancedFilterApply"),this.activateTabIndex([this.eApplyFilterButton]),this.addManagedListener(this.eApplyFilterButton,"click",(function(){return t.onValueConfirmed(t.eAutocomplete.isValid())})),e._.setDisabled(this.eApplyFilterButton,this.isApplyDisabled)},r.prototype.setupBuilderButton=function(){var t=this;this.eBuilderFilterButtonIcon.appendChild(e._.createIconNoSpan("advancedFilterBuilder",this.gridOptionsService)),this.eBuilderFilterButtonLabel.innerText=this.advancedFilterExpressionService.translate("advancedFilterBuilder"),this.activateTabIndex([this.eBuilderFilterButton]),this.addManagedListener(this.eBuilderFilterButton,"click",(function(){return t.openBuilder()})),this.addManagedListener(this.advancedFilterService.getCtrl(),te.EVENT_BUILDER_CLOSED,(function(){return t.closeBuilder()}))},r.prototype.onValueChanged=function(t){var r;t=e._.makeNull(t),this.advancedFilterService.setExpressionDisplayValue(t),this.expressionParser=this.advancedFilterService.createExpressionParser(t);var i=null===(r=this.expressionParser)||void 0===r?void 0:r.parseExpression();i&&i!==t&&this.eAutocomplete.setValue({value:i,silent:!0,restoreFocus:!0})},r.prototype.onValueConfirmed=function(t){t&&!this.isApplyDisabled&&(e._.setDisabled(this.eApplyFilterButton,!0),this.advancedFilterService.applyExpression(),this.filterManager.onFilterChanged({source:"advancedFilter"}))},r.prototype.onOptionSelected=function(e,t,r){var i=this.updateExpression(e,t,r),o=i.updatedValue,n=i.updatedPosition,a=i.hideAutocomplete;this.eAutocomplete.setValue({value:o,position:n,updateListOnlyIfOpen:a,restoreFocus:!0})},r.prototype.validateValue=function(){var e,t,r;return(null===(e=this.expressionParser)||void 0===e?void 0:e.isValid())?null:null!==(r=null===(t=this.expressionParser)||void 0===t?void 0:t.getValidationMessage())&&void 0!==r?r:null},r.prototype.onValidChanged=function(t,r){this.isApplyDisabled=!t||this.advancedFilterService.isCurrentExpressionApplied(),e._.setDisabled(this.eApplyFilterButton,this.isApplyDisabled),this.setTooltip(r,1e3)},r.prototype.generateAutocompleteListParams=function(e){return this.expressionParser?this.expressionParser.getAutocompleteListParams(e):this.advancedFilterExpressionService.getDefaultAutocompleteListParams("")},r.prototype.updateExpression=function(e,t,r){var i,o;return this.advancedFilterExpressionService.updateAutocompleteCache(t,r),null!==(o=null===(i=this.expressionParser)||void 0===i?void 0:i.updateExpression(e,t,r))&&void 0!==o?o:this.advancedFilterService.getDefaultExpression(t)},r.prototype.forceLastSelection=function(e,t){var r=e.key,i=e.displayValue;return!!t.toLocaleLowerCase().match("^".concat((null!=i?i:r).toLocaleLowerCase(),"\\s*$"))},r.prototype.openBuilder=function(){this.builderOpen||(this.builderOpen=!0,e._.setDisabled(this.eBuilderFilterButton,!0),this.advancedFilterService.getCtrl().toggleFilterBuilder("ui"))},r.prototype.closeBuilder=function(){this.builderOpen&&(this.builderOpen=!1,e._.setDisabled(this.eBuilderFilterButton,!1),this.eBuilderFilterButton.focus())},ie([e.RefSelector("eAutocomplete")],r.prototype,"eAutocomplete",void 0),ie([e.RefSelector("eApplyFilterButton")],r.prototype,"eApplyFilterButton",void 0),ie([e.RefSelector("eBuilderFilterButton")],r.prototype,"eBuilderFilterButton",void 0),ie([e.RefSelector("eBuilderFilterButtonIcon")],r.prototype,"eBuilderFilterButtonIcon",void 0),ie([e.RefSelector("eBuilderFilterButtonLabel")],r.prototype,"eBuilderFilterButtonLabel",void 0),ie([e.Autowired("advancedFilterService")],r.prototype,"advancedFilterService",void 0),ie([e.Autowired("advancedFilterExpressionService")],r.prototype,"advancedFilterExpressionService",void 0),ie([e.Autowired("filterManager")],r.prototype,"filterManager",void 0),ie([e.PostConstruct],r.prototype,"postConstruct",null),r}(e.Component),ne={ariaAdvancedFilterBuilderItem:function(e){return"".concat(e[0],". Level ").concat(e[1],". Press ENTER to edit.")},ariaAdvancedFilterBuilderItemValidation:function(e){return"".concat(e[0],". Level ").concat(e[1],". ").concat(e[2]," Press ENTER to edit.")},ariaAdvancedFilterBuilderList:"Advanced Filter Builder List",ariaAdvancedFilterBuilderFilterItem:"Filter Condition",ariaAdvancedFilterBuilderGroupItem:"Filter Group",ariaAdvancedFilterBuilderColumn:"Column",ariaAdvancedFilterBuilderOption:"Option",ariaAdvancedFilterBuilderValue:"Value",ariaAdvancedFilterBuilderJoinOperator:"Join Operator",ariaAdvancedFilterInput:"Advanced Filter Input",ariaLabelAdvancedFilterAutocomplete:"Advanced Filter Autocomplete",advancedFilterContains:"contains",advancedFilterNotContains:"does not contain",advancedFilterTextEquals:"equals",advancedFilterTextNotEqual:"does not equal",advancedFilterStartsWith:"begins with",advancedFilterEndsWith:"ends with",advancedFilterBlank:"is blank",advancedFilterNotBlank:"is not blank",advancedFilterEquals:"=",advancedFilterNotEqual:"!=",advancedFilterGreaterThan:">",advancedFilterGreaterThanOrEqual:">=",advancedFilterLessThan:"<",advancedFilterLessThanOrEqual:"<=",advancedFilterTrue:"is true",advancedFilterFalse:"is false",advancedFilterAnd:"AND",advancedFilterOr:"OR",advancedFilterApply:"Apply",advancedFilterBuilder:"Builder",advancedFilterValidationMissingColumn:"Column is missing",advancedFilterValidationMissingOption:"Option is missing",advancedFilterValidationMissingValue:"Value is missing",advancedFilterValidationInvalidColumn:"Column not found",advancedFilterValidationInvalidOption:"Option not found",advancedFilterValidationMissingQuote:"Value is missing an end quote",advancedFilterValidationNotANumber:"Value is not a number",advancedFilterValidationInvalidDate:"Value is not a valid date",advancedFilterValidationMissingCondition:"Condition is missing",advancedFilterValidationJoinOperatorMismatch:"Join operators within a condition must be the same",advancedFilterValidationInvalidJoinOperator:"Join operator not found",advancedFilterValidationMissingEndBracket:"Missing end bracket",advancedFilterValidationExtraEndBracket:"Too many end brackets",advancedFilterValidationMessage:function(e){return"Expression has an error. ".concat(e[0]," - ").concat(e[1],".")},advancedFilterValidationMessageAtEnd:function(e){return"Expression has an error. ".concat(e[0]," at end of expression.")},advancedFilterBuilderTitle:"Advanced Filter",advancedFilterBuilderApply:"Apply",advancedFilterBuilderCancel:"Cancel",advancedFilterBuilderAddButtonTooltip:"Add Filter or Group",advancedFilterBuilderRemoveButtonTooltip:"Remove",advancedFilterBuilderMoveUpButtonTooltip:"Move Up",advancedFilterBuilderMoveDownButtonTooltip:"Move Down",advancedFilterBuilderAddJoin:"Add Group",advancedFilterBuilderAddCondition:"Add Filter",advancedFilterBuilderSelectColumn:"Select a column",advancedFilterBuilderSelectOption:"Select an option",advancedFilterBuilderEnterValue:"Enter a value...",advancedFilterBuilderValidationAlreadyApplied:"Current filter already applied.",advancedFilterBuilderValidationIncomplete:"Not all conditions are complete.",advancedFilterBuilderValidationSelectColumn:"Must select a column.",advancedFilterBuilderValidationSelectOption:"Must select an option.",advancedFilterBuilderValidationEnterValue:"Must enter a value."};function ae(e,t,r){if(!e)return"";var i=r-t;return i?e.slice(0,e.length-i):e}function se(e,t,r,i,o,n,a){var s=r+(!e.length||a?0:1),l=0;return o&&(" "===e[s]?l=1:(i+=" ",n&&(i+='"'))),{updatedValue:e.slice(0,t)+i+e.slice(s),updatedPosition:t+i.length+l}}function le(e,t,r,i){for(var o=t,n=!1;o<e.length;){var a=e[o];if("("===a){i&&" "===e[o-1]?n=!0:o-=1;break}if(" "===a||r&&")"===a){o-=1;break}o++}return{endPosition:o,isEmpty:n}}function ce(e,t,r,i){r!==t&&(e.expression=se(e.expression,i-t.length+1,i,r).updatedValue)}var ue=function(){return(ue=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},de=function(){function e(e,t){this.params=e,this.startPosition=t,this.type="column",this.valid=!0,this.hasStartChar=!1,this.hasEndChar=!1,this.colName=""}return e.prototype.parse=function(e,t){if(e!==fe.COL_START_CHAR||this.colName)if(e===fe.COL_END_CHAR&&this.hasStartChar){if(this.parseColumn(!1,t))return this.hasEndChar=!0,!1;this.colName+=e}else this.colName+=e;else this.hasStartChar=!0},e.prototype.getDisplayValue=function(){return(this.hasStartChar?fe.COL_START_CHAR:"")+this.colName+(this.hasEndChar?fe.COL_END_CHAR:"")},e.prototype.getColId=function(){return this.colId},e.prototype.complete=function(e){this.parseColumn(!0,e)},e.prototype.getValidationError=function(){var e;return this.valid?null:{message:this.params.advancedFilterExpressionService.translate("advancedFilterValidationInvalidColumn"),startPosition:this.startPosition,endPosition:null!==(e=this.endPosition)&&void 0!==e?e:this.params.expression.length-1}},e.prototype.parseColumn=function(e,t){var r;this.endPosition=t;var i=this.params.advancedFilterExpressionService.getColId(this.colName);return i&&this.hasStartChar&&(this.colId=i.colId,ce(this.params,this.colName,i.columnName,t-1),this.colName=i.columnName,this.column=this.params.columnModel.getPrimaryColumn(this.colId),this.column)?(this.baseCellDataType=null!==(r=this.params.dataTypeService.getBaseDataType(this.column))&&void 0!==r?r:"text",!0):(e&&(this.valid=!1),this.baseCellDataType="text",!1)},e}(),pe=function(){function e(e,t,r){this.params=e,this.startPosition=t,this.baseCellDataType=r,this.type="operator",this.valid=!0,this.expectedNumOperands=0,this.operator=""}return e.prototype.parse=function(e,t){if(" "===e||")"===e){if(this.parseOperator(!1,t-1))return!0;this.operator+=e}else this.operator+=e},e.prototype.complete=function(e){this.parseOperator(!0,e)},e.prototype.getValidationError=function(){var e;return this.valid?null:{message:this.params.advancedFilterExpressionService.translate("advancedFilterValidationInvalidOption"),startPosition:this.startPosition,endPosition:null!==(e=this.endPosition)&&void 0!==e?e:this.params.expression.length-1}},e.prototype.getDisplayValue=function(){return this.operator},e.prototype.getOperatorKey=function(){return this.parsedOperator},e.prototype.parseOperator=function(e,t){var r=this.params.advancedFilterExpressionService.getDataTypeExpressionOperator(this.baseCellDataType),i=r.findOperator(this.operator);if(this.endPosition=t,i){this.parsedOperator=i;var o=r.operators[i];this.expectedNumOperands=o.numOperands;var n=o.displayValue;return ce(this.params,this.operator,n,t),this.operator=n,!0}return!e&&null===i||(this.valid=!1),!1},e}(),he=function(){function e(e,t,r,i){this.params=e,this.startPosition=t,this.baseCellDataType=r,this.column=i,this.type="operand",this.valid=!0,this.operand="",this.validationMessage=null}return e.prototype.parse=function(e,t){if(" "===e){if(!this.quotes)return this.parseOperand(!1,t),!0;this.operand+=e}else if(")"===e){if("number"===this.baseCellDataType||!this.quotes)return this.parseOperand(!1,t-1),!0;this.operand+=e}else if(this.operand||this.quotes||"'"!==e&&'"'!==e){if(this.quotes&&e===this.quotes)return this.parseOperand(!1,t),!1;this.operand+=e}else this.quotes=e},e.prototype.complete=function(e){this.parseOperand(!0,e)},e.prototype.getValidationError=function(){var e;return this.validationMessage?{message:this.validationMessage,startPosition:this.startPosition,endPosition:null!==(e=this.endPosition)&&void 0!==e?e:this.params.expression.length-1}:null},e.prototype.getRawValue=function(){return this.operand},e.prototype.getModelValue=function(){return this.modelValue},e.prototype.parseOperand=function(e,t){var r=this.params.advancedFilterExpressionService;if(this.endPosition=t,this.modelValue=this.operand,e&&this.quotes)this.valid=!1,this.validationMessage=r.translate("advancedFilterValidationMissingQuote");else if(""===this.modelValue)this.valid=!1,this.validationMessage=r.translate("advancedFilterValidationMissingValue");else{var i=r.getOperandModelValue(this.operand,this.baseCellDataType,this.column);switch(null!=i&&(this.modelValue=i),this.baseCellDataType){case"number":(this.quotes||isNaN(this.modelValue))&&(this.valid=!1,this.validationMessage=r.translate("advancedFilterValidationNotANumber"));break;case"date":case"dateString":null==i&&(this.valid=!1,this.validationMessage=r.translate("advancedFilterValidationInvalidDate"))}}},e}(),fe=function(){function e(e,t){this.params=e,this.startPosition=t,this.isAwaiting=!0}return e.prototype.parseExpression=function(){for(var e,t,r=this.startPosition,i=this.params.expression;r<i.length;){var o=i[r];if(" "===o&&this.isAwaiting);else{if(this.isAwaiting=!1,!this.parser){var n=void 0;this.columnParser?this.operatorParser?(this.operandParser=new he(this.params,r,this.columnParser.baseCellDataType,this.columnParser.column),n=this.operandParser):(this.operatorParser=new pe(this.params,r,this.columnParser.baseCellDataType),n=this.operatorParser):(this.columnParser=new de(this.params,r),n=this.columnParser),this.parser=n}var a=this.parser.parse(o,r);if(null!=a){if(this.isComplete())return this.returnEndPosition(a?r-1:r,!0);this.parser=void 0,this.isAwaiting=!0}}r++}return null===(t=null===(e=this.parser)||void 0===e?void 0:e.complete)||void 0===t||t.call(e,r-1),this.returnEndPosition(r)},e.prototype.isValid=function(){return this.isComplete()&&this.columnParser.valid&&this.operatorParser.valid&&(!this.operandParser||this.operandParser.valid)},e.prototype.getValidationError=function(){var e,t,r,i,o,n=null!==(i=null!==(t=null===(e=this.columnParser)||void 0===e?void 0:e.getValidationError())&&void 0!==t?t:null===(r=this.operatorParser)||void 0===r?void 0:r.getValidationError())&&void 0!==i?i:null===(o=this.operandParser)||void 0===o?void 0:o.getValidationError();if(n)return n;var a,s=this.params.expression.length;return this.columnParser?this.operatorParser?this.operatorParser.expectedNumOperands&&!this.operandParser&&(a="advancedFilterValidationMissingValue"):a="advancedFilterValidationMissingOption":a="advancedFilterValidationMissingColumn",a?{message:this.params.advancedFilterExpressionService.translate(a),startPosition:s,endPosition:s}:null},e.prototype.getFunction=function(e){var t,r,i,o=this.columnParser.getColId(),n=o.replace(/(['"])/,"\\$1"),a=null===(t=this.operatorParser)||void 0===t?void 0:t.getOperatorKey(),s=e.operators,l=e.evaluatorParams,c=e.operands,u=this.params.advancedFilterExpressionService.getExpressionOperator(this.columnParser.baseCellDataType,a),d=this.addToListAndGetIndex(s,u),p=this.params.advancedFilterExpressionService.getExpressionEvaluatorParams(o),h=this.addToListAndGetIndex(l,p);if(0===(null===(r=this.operatorParser)||void 0===r?void 0:r.expectedNumOperands))i="";else{var f=this.addToListAndGetIndex(c,this.getOperandValue());i=", params.operands[".concat(f,"]")}return"params.operators[".concat(d,"].evaluator(expressionProxy.getValue('").concat(n,"', node), node, params.evaluatorParams[").concat(h,"]").concat(i,")")},e.prototype.getAutocompleteListParams=function(e){return this.isColumnPosition(e)?this.getColumnAutocompleteListParams(e):this.isOperatorPosition(e)?this.getOperatorAutocompleteListParams(e):this.isBeyondEndPosition(e)?void 0:{enabled:!1}},e.prototype.updateExpression=function(e,t,r){var i,o,n,a,s,l=this.params.expression;if(this.isColumnPosition(e))return se(this.params.expression,this.startPosition,(null===(i=this.columnParser)||void 0===i?void 0:i.getColId())?this.columnParser.endPosition:le(l,e).endPosition,this.params.advancedFilterExpressionService.getColumnValue(t),!0);if(this.isOperatorPosition(e)){var c=this.getBaseCellDataTypeFromOperatorAutocompleteType(r),u=this.hasOperand(c,t.key),d=u&&this.doesOperandNeedQuotes(c),p=void 0;if(null!=(null===(o=this.operatorParser)||void 0===o?void 0:o.startPosition)&&e<this.operatorParser.startPosition)p=se(l,e,e,null!==(n=t.displayValue)&&void 0!==n?n:t.key,u,d);else{var h=void 0,f=!1;if(null===(a=this.operatorParser)||void 0===a?void 0:a.getOperatorKey())h=this.operatorParser.endPosition;else{var g=le(l,e,!0,!0);h=g.endPosition,f=g.isEmpty}p=se(l,function(e,t,r){for(var i=t;i<r;){if(" "!==e[i])break;i++}return i}(l,this.columnParser.endPosition+1,h),h,null!==(s=t.displayValue)&&void 0!==s?s:t.key,u,d,f)}return ue(ue({},p),{hideAutocomplete:!u})}return null},e.prototype.getModel=function(){var e=this.columnParser.getColId(),t={filterType:this.columnParser.baseCellDataType,colId:e,type:this.operatorParser.getOperatorKey()};return this.operatorParser.expectedNumOperands&&(t.filter=this.operandParser.getModelValue()),t},e.prototype.getOperandValue=function(){var e=this.operandParser.getRawValue(),t=this.columnParser,r=t.baseCellDataType,i=t.column;switch(r){case"number":e=Number(e);break;case"date":case"dateString":e=this.params.valueParserService.parseValue(i,null,e,void 0)}return"dateString"===r?this.params.dataTypeService.getDateParserFunction()(e):e},e.prototype.isComplete=function(){return!(!this.operatorParser||!(!this.operatorParser.expectedNumOperands||this.operatorParser.expectedNumOperands&&this.operandParser))},e.prototype.isColumnPosition=function(e){return!this.columnParser||null==this.columnParser.endPosition||e<=this.columnParser.endPosition+1},e.prototype.isOperatorPosition=function(e){return!this.operatorParser||null==this.operatorParser.endPosition||e<=this.operatorParser.endPosition+1},e.prototype.isBeyondEndPosition=function(e){return this.isComplete()&&null!=this.endPosition&&e>this.endPosition+1&&this.endPosition+1<this.params.expression.length},e.prototype.returnEndPosition=function(e,t){return this.endPosition=t?e:e-1,e},e.prototype.getColumnAutocompleteListParams=function(e){return this.params.advancedFilterExpressionService.generateAutocompleteListParams(this.params.advancedFilterExpressionService.getColumnAutocompleteEntries(),"column",this.getColumnSearchString(e))},e.prototype.getColumnSearchString=function(e){var t,r,i,o,n,a=null!==(r=null===(t=this.columnParser)||void 0===t?void 0:t.getDisplayValue())&&void 0!==r?r:"",s=ae(a,e,null==(null===(i=this.columnParser)||void 0===i?void 0:i.endPosition)?this.params.expression.length:this.columnParser.endPosition+1),l=(null===(o=this.columnParser)||void 0===o?void 0:o.hasStartChar)&&s.length>0,c=(null===(n=this.columnParser)||void 0===n?void 0:n.hasEndChar)&&s.length===a.length+2;return l?s.slice(1,c?-1:void 0):s},e.prototype.getOperatorAutocompleteListParams=function(e){var t,r,i,o,n,a=null===(t=this.columnParser)||void 0===t?void 0:t.column;if(!a)return{enabled:!1};var s=this.columnParser.baseCellDataType,l=null!=(null===(r=this.operatorParser)||void 0===r?void 0:r.startPosition)&&e<this.operatorParser.startPosition?"":ae(null!==(o=null===(i=this.operatorParser)||void 0===i?void 0:i.getDisplayValue())&&void 0!==o?o:"",e,null==(null===(n=this.operatorParser)||void 0===n?void 0:n.endPosition)?this.params.expression.length:this.operatorParser.endPosition+1);return this.params.advancedFilterExpressionService.generateAutocompleteListParams(this.params.advancedFilterExpressionService.getOperatorAutocompleteEntries(a,s),"operator-".concat(s),l)},e.prototype.getBaseCellDataTypeFromOperatorAutocompleteType=function(e){return null==e?void 0:e.replace("operator-","")},e.prototype.hasOperand=function(e,t){var r,i;return!e||!t||(null!==(i=null===(r=this.params.advancedFilterExpressionService.getExpressionOperator(e,t))||void 0===r?void 0:r.numOperands)&&void 0!==i?i:0)>0},e.prototype.doesOperandNeedQuotes=function(e){return"number"!==e},e.prototype.addToListAndGetIndex=function(e,t){var r=e.length;return e.push(t),r},e.COL_START_CHAR="[",e.COL_END_CHAR="]",e}(),ge=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,o,n=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(e){o={error:e}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a};function ye(e,t,r){var i=!1,o=e.toLocaleLowerCase(),n=o+" ",a=Object.entries(t).find((function(e){var t=ge(e,2),a=(t[0],t[1]),s=r(a).toLocaleLowerCase();return s.startsWith(n)&&(i=!0),s===o}));return a?a[0]:i?null:void 0}function ve(e,t){return(null!=t?t:Object.keys(e)).map((function(t){return{key:t,displayValue:e[t].displayValue}}))}var me=function(){function e(e){this.params=e,this.initOperators()}return e.prototype.getEntries=function(e){return ve(this.operators,e)},e.prototype.findOperator=function(e){return ye(e,this.operators,(function(e){return e.displayValue}))},e.prototype.initOperators=function(){var e=this,t=this.params.translate;this.operators={contains:{displayValue:t("advancedFilterContains"),evaluator:function(t,r,i,o){return e.evaluateExpression(t,r,i,o,!1,(function(e,t){return e.includes(t)}))},numOperands:1},notContains:{displayValue:t("advancedFilterNotContains"),evaluator:function(t,r,i,o){return e.evaluateExpression(t,r,i,o,!0,(function(e,t){return!e.includes(t)}))},numOperands:1},equals:{displayValue:t("advancedFilterTextEquals"),evaluator:function(t,r,i,o){return e.evaluateExpression(t,r,i,o,!1,(function(e,t){return e===t}))},numOperands:1},notEqual:{displayValue:t("advancedFilterTextNotEqual"),evaluator:function(t,r,i,o){return e.evaluateExpression(t,r,i,o,!0,(function(e,t){return e!=t}))},numOperands:1},startsWith:{displayValue:t("advancedFilterStartsWith"),evaluator:function(t,r,i,o){return e.evaluateExpression(t,r,i,o,!1,(function(e,t){return e.startsWith(t)}))},numOperands:1},endsWith:{displayValue:t("advancedFilterEndsWith"),evaluator:function(t,r,i,o){return e.evaluateExpression(t,r,i,o,!1,(function(e,t){return e.endsWith(t)}))},numOperands:1},blank:{displayValue:t("advancedFilterBlank"),evaluator:function(e){return null==e||"string"==typeof e&&0===e.trim().length},numOperands:0},notBlank:{displayValue:t("advancedFilterNotBlank"),evaluator:function(e){return null!=e&&("string"!=typeof e||e.trim().length>0)},numOperands:0}}},e.prototype.evaluateExpression=function(e,t,r,i,o,n){return null==e?o:r.caseSensitive?n(r.valueConverter(e,t),i):n(r.valueConverter(e,t).toLocaleLowerCase(),i.toLocaleLowerCase())},e}(),Ce=function(){function e(e){this.params=e,this.initOperators()}return e.prototype.getEntries=function(e){return ve(this.operators,e)},e.prototype.findOperator=function(e){return ye(e,this.operators,(function(e){return e.displayValue}))},e.prototype.initOperators=function(){var e=this,t=this.params,r=t.translate,i=t.equals;this.operators={equals:{displayValue:r("advancedFilterEquals"),evaluator:function(t,r,o,n){return e.evaluateSingleOperandExpression(t,r,o,n,!!o.includeBlanksInEquals,i)},numOperands:1},notEqual:{displayValue:r("advancedFilterNotEqual"),evaluator:function(t,r,o,n){return e.evaluateSingleOperandExpression(t,r,o,n,!!o.includeBlanksInEquals,(function(e,t){return!i(e,t)}))},numOperands:1},greaterThan:{displayValue:r("advancedFilterGreaterThan"),evaluator:function(t,r,i,o){return e.evaluateSingleOperandExpression(t,r,i,o,!!i.includeBlanksInGreaterThan,(function(e,t){return e>t}))},numOperands:1},greaterThanOrEqual:{displayValue:r("advancedFilterGreaterThanOrEqual"),evaluator:function(t,r,i,o){return e.evaluateSingleOperandExpression(t,r,i,o,!!i.includeBlanksInGreaterThan,(function(e,t){return e>=t}))},numOperands:1},lessThan:{displayValue:r("advancedFilterLessThan"),evaluator:function(t,r,i,o){return e.evaluateSingleOperandExpression(t,r,i,o,!!i.includeBlanksInLessThan,(function(e,t){return e<t}))},numOperands:1},lessThanOrEqual:{displayValue:r("advancedFilterLessThanOrEqual"),evaluator:function(t,r,i,o){return e.evaluateSingleOperandExpression(t,r,i,o,!!i.includeBlanksInLessThan,(function(e,t){return e<=t}))},numOperands:1},blank:{displayValue:r("advancedFilterBlank"),evaluator:function(e){return null==e},numOperands:0},notBlank:{displayValue:r("advancedFilterNotBlank"),evaluator:function(e){return null!=e},numOperands:0}}},e.prototype.evaluateSingleOperandExpression=function(e,t,r,i,o,n){return null==e?o:n(r.valueConverter(e,t),i)},e}(),be=function(){function e(e){this.params=e,this.initOperators()}return e.prototype.getEntries=function(e){return ve(this.operators,e)},e.prototype.findOperator=function(e){return ye(e,this.operators,(function(e){return e.displayValue}))},e.prototype.initOperators=function(){var e=this.params.translate;this.operators={true:{displayValue:e("advancedFilterTrue"),evaluator:function(e){return!!e},numOperands:0},false:{displayValue:e("advancedFilterFalse"),evaluator:function(e){return!1===e},numOperands:0},blank:{displayValue:e("advancedFilterBlank"),evaluator:function(e){return null==e},numOperands:0},notBlank:{displayValue:e("advancedFilterNotBlank"),evaluator:function(e){return null!=e},numOperands:0}}},e}(),Se=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),xe=function(e,t,r,i){var o,n=arguments.length,a=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(n<3?o(a):n>3?o(t,r,a):o(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a},we=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,o,n=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(e){o={error:e}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a},Ee=function(t){function r(){var e=null!==t&&t.apply(this,arguments)||this;return e.columnNameToIdMap={},e.columnAutocompleteEntries=null,e.expressionEvaluatorParams={},e}return Se(r,t),r.prototype.postConstruct=function(){this.expressionJoinOperators=this.generateExpressionJoinOperators(),this.expressionOperators=this.generateExpressionOperators()},r.prototype.parseJoinOperator=function(e){var t,r=e.type;return null!==(t=this.expressionJoinOperators[r])&&void 0!==t?t:r},r.prototype.getColumnDisplayValue=function(e){var t,r=e.colId,i=this.getColumnAutocompleteEntries().find((function(e){return e.key===r}));return i?(t=i.displayValue,this.columnNameToIdMap[t.toLocaleUpperCase()]={colId:r,columnName:t}):t=r,t},r.prototype.getOperatorDisplayValue=function(e){var t,r;return null!==(r=null===(t=this.getExpressionOperator(e.filterType,e.type))||void 0===t?void 0:t.displayValue)&&void 0!==r?r:e.type},r.prototype.getOperandModelValue=function(t,r,i){var o;switch(r){case"number":return e._.exists(t)?Number(t):null;case"date":return e._.serialiseDate(this.valueParserService.parseValue(i,null,t,void 0),!1);case"dateString":var n=this.valueParserService.parseValue(i,null,t,void 0);return e._.serialiseDate(null!==(o=this.dataTypeService.getDateParserFunction()(n))&&void 0!==o?o:null,!1)}return t},r.prototype.getOperandDisplayValue=function(t,r){var i,o,n=t,a=n.colId,s=n.filter,l=this.columnModel.getPrimaryColumn(a),c="";if(null!=s){var u=void 0;switch(t.filterType){case"number":u=null!==(i=e._.toStringOrNull(s))&&void 0!==i?i:"";break;case"date":var d=e._.parseDateTimeFromString(s);u=l?this.valueFormatterService.formatValue(l,null,d):null;break;case"dateString":var p=e._.parseDateTimeFromString(s),h=l?this.dataTypeService.getDateFormatterFunction()(null!=p?p:void 0):null;u=l?this.valueFormatterService.formatValue(l,null,h):null}"number"!==t.filterType&&(u=null!==(o=null!=u?u:e._.toStringOrNull(s))&&void 0!==o?o:"",r||(u='"'.concat(u,'"'))),c=r?u:" ".concat(u)}return c},r.prototype.parseColumnFilterModel=function(e){var t,r,i=null!==(t=this.getColumnDisplayValue(e))&&void 0!==t?t:"",o=null!==(r=this.getOperatorDisplayValue(e))&&void 0!==r?r:"",n=this.getOperandDisplayValue(e);return"[".concat(i,"] ").concat(o).concat(n)},r.prototype.updateAutocompleteCache=function(e,t){if("column"===t){var r=e.key,i=e.displayValue;this.columnNameToIdMap[e.displayValue.toLocaleUpperCase()]={colId:r,columnName:i}}},r.prototype.translate=function(e,t){var r=ne[e];return"function"==typeof r&&(r=r(t)),this.localeService.getLocaleTextFunc()(e,r,t)},r.prototype.generateAutocompleteListParams=function(e,t,r){return{enabled:!0,type:t,searchString:r,entries:e}},r.prototype.getColumnAutocompleteEntries=function(){var e,t=this;if(this.columnAutocompleteEntries)return this.columnAutocompleteEntries;var r=null!==(e=this.columnModel.getAllPrimaryColumns())&&void 0!==e?e:[],i=[],o=this.gridOptionsService.get("includeHiddenColumnsInAdvancedFilter");return r.forEach((function(e){e.getColDef().filter&&(o||e.isVisible()||e.isRowGroupActive())&&i.push({key:e.getColId(),displayValue:t.columnModel.getDisplayNameForColumn(e,"advancedFilter")})})),i.sort((function(e,t){var r,i,o=null!==(r=e.displayValue)&&void 0!==r?r:"",n=null!==(i=t.displayValue)&&void 0!==i?i:"";return o<n?-1:n>o?1:0})),i},r.prototype.getOperatorAutocompleteEntries=function(e,t){var r=this.getActiveOperators(e);return this.getDataTypeExpressionOperator(t).getEntries(r)},r.prototype.getJoinOperatorAutocompleteEntries=function(){return Object.entries(this.expressionJoinOperators).map((function(e){var t=we(e,2);return{key:t[0],displayValue:t[1]}}))},r.prototype.getDefaultAutocompleteListParams=function(e){return this.generateAutocompleteListParams(this.getColumnAutocompleteEntries(),"column",e)},r.prototype.getDataTypeExpressionOperator=function(e){return this.expressionOperators[e]},r.prototype.getExpressionOperator=function(e,t){var r,i;return null===(i=null===(r=this.getDataTypeExpressionOperator(e))||void 0===r?void 0:r.operators)||void 0===i?void 0:i[t]},r.prototype.getExpressionJoinOperators=function(){return this.expressionJoinOperators},r.prototype.getColId=function(e){var t=e.toLocaleUpperCase(),r=this.columnNameToIdMap[t];if(r)return r;var i=this.getColumnAutocompleteEntries().find((function(e){return e.displayValue.toLocaleUpperCase()===t}));if(i){var o={colId:i.key,columnName:i.displayValue};return this.columnNameToIdMap[t]=o,o}return null},r.prototype.getExpressionEvaluatorParams=function(t){var r=this,i=this.expressionEvaluatorParams[t];if(i)return i;var o=this.columnModel.getPrimaryColumn(t);if(!o)return{valueConverter:function(e){return e}};switch(this.dataTypeService.getBaseDataType(o)){case"dateString":i={valueConverter:this.dataTypeService.getDateParserFunction()};break;case"object":i=o.getColDef().filterValueGetter?{valueConverter:function(e){return e}}:{valueConverter:function(e,t){var i;return null!==(i=r.valueFormatterService.formatValue(o,t,e))&&void 0!==i?i:"function"==typeof e.toString?e.toString():""}};break;case"text":case void 0:i={valueConverter:function(t){return e._.toStringOrNull(t)}};break;default:i={valueConverter:function(e){return e}}}var n=o.getColDef().filterParams;return n&&["caseSensitive","includeBlanksInEquals","includeBlanksInLessThan","includeBlanksInGreaterThan"].forEach((function(e){var t=n[e];t&&(i[e]=t)})),this.expressionEvaluatorParams[t]=i,i},r.prototype.getColumnDetails=function(e){var t,r,i=null!==(t=this.columnModel.getPrimaryColumn(e))&&void 0!==t?t:void 0;return{column:i,baseCellDataType:null!==(r=i?this.dataTypeService.getBaseDataType(i):void 0)&&void 0!==r?r:"text"}},r.prototype.generateExpressionOperators=function(){var e=this,t=function(t,r){return e.translate(t,r)};return{text:new me({translate:t}),boolean:new be({translate:t}),object:new me({translate:t}),number:new Ce({translate:t,equals:function(e,t){return e===t}}),date:new Ce({translate:t,equals:function(e,t){return e.getTime()===t.getTime()}}),dateString:new Ce({translate:t,equals:function(e,t){return e.getTime()===t.getTime()}})}},r.prototype.getColumnValue=function(e){var t=e.displayValue;return"".concat(fe.COL_START_CHAR).concat(t).concat(fe.COL_END_CHAR)},r.prototype.generateExpressionJoinOperators=function(){return{AND:this.translate("advancedFilterAnd"),OR:this.translate("advancedFilterOr")}},r.prototype.getActiveOperators=function(e){var t,r=null===(t=e.getColDef().filterParams)||void 0===t?void 0:t.filterOptions;if(r)return r.every((function(e){return"string"==typeof e}))?r:void 0},r.prototype.resetColumnCaches=function(){this.columnAutocompleteEntries=null,this.columnNameToIdMap={},this.expressionEvaluatorParams={}},xe([e.Autowired("valueFormatterService")],r.prototype,"valueFormatterService",void 0),xe([e.Autowired("valueParserService")],r.prototype,"valueParserService",void 0),xe([e.Autowired("columnModel")],r.prototype,"columnModel",void 0),xe([e.Autowired("dataTypeService")],r.prototype,"dataTypeService",void 0),xe([e.PostConstruct],r.prototype,"postConstruct",null),r=xe([e.Bean("advancedFilterExpressionService")],r)}(e.BeanStub),Ae=function(){function e(e){this.params=e,this.operators=[],this.operatorStartPositions=[],this.operatorEndPositions=[],this.activeOperator=0,this.validationError=null}return e.prototype.parseExpression=function(e){this.operators.push(""),this.operatorStartPositions.push(e),this.operatorEndPositions.push(void 0);for(var t=this.params.expression;e<t.length;){var r=t[e];if(" "===r){if(this.parseOperator(e-1))return this.activeOperator++,e-1;this.operators[this.activeOperator]+=r}else this.operators[this.activeOperator]+=r;e++}return this.parseOperator(e-1),e},e.prototype.isValid=function(){return!(this.validationError||this.operators.length&&!this.parsedOperator)},e.prototype.getValidationError=function(){return this.validationError},e.prototype.getFunction=function(){return"OR"===this.parsedOperator?"||":"&&"},e.prototype.getModel=function(){return"OR"===this.parsedOperator?"OR":"AND"},e.prototype.getAutocompleteListParams=function(e,t){var r,i=this;if(null==t)r="";else{var o=this.operators[t],n=this.operatorEndPositions[t];r=ae(o,e,null==n?this.params.expression.length:n+1)}var a=this.params.advancedFilterExpressionService.getJoinOperatorAutocompleteEntries();return(t||null==t&&this.activeOperator)&&(a=a.filter((function(e){return e.key===i.parsedOperator}))),this.params.advancedFilterExpressionService.generateAutocompleteListParams(a,"join",r)},e.prototype.updateExpression=function(e,t,r){var i,o,n=this.params.expression,a=null!==(i=t.displayValue)&&void 0!==i?i:t.key;if(0===r)for(var s=this.operatorEndPositions.length-1;s>0;s--){var l=this.operatorEndPositions[s];null!=l&&(n=se(n,this.operatorStartPositions[s],l,a).updatedValue)}return se(n,this.operatorStartPositions.length>r?this.operatorStartPositions[r]:e,null!==(o=this.operatorEndPositions.length>r?this.operatorEndPositions[r]:void 0)&&void 0!==o?o:le(n,e,!0).endPosition,a,!0)},e.prototype.getNumOperators=function(){return this.operators.length},e.prototype.getLastOperatorEndPosition=function(){return this.operatorEndPositions[this.operatorEndPositions.length-1]},e.prototype.parseOperator=function(e){var t=this.operators.length>this.activeOperator?this.operators[this.activeOperator]:"",r=this.params.advancedFilterExpressionService.getExpressionJoinOperators(),i=ye(t,r,(function(e){return e}));if(i){this.operatorEndPositions[this.activeOperator]=e;var o=r[i];if(this.activeOperator){if(i!==this.parsedOperator)return this.validationError||(this.validationError={message:this.params.advancedFilterExpressionService.translate("advancedFilterValidationJoinOperatorMismatch"),startPosition:e-t.length+1,endPosition:e}),!1}else this.parsedOperator=i;return t!==o&&(ce(this.params,t,o,e),this.operators[this.activeOperator]=o),!0}return null!==i&&(this.validationError||(this.validationError={message:this.params.advancedFilterExpressionService.translate("advancedFilterValidationInvalidJoinOperator"),startPosition:e-t.length+1,endPosition:e}),!0)},e}(),Oe=function(){function e(e,t){this.params=e,this.startPosition=t,this.expectingExpression=!0,this.expectingOperator=!1,this.expressionParsers=[],this.operatorParser=new Ae(this.params),this.missingEndBracket=!1,this.extraEndBracket=!1}return e.prototype.parseExpression=function(){for(var t=this.startPosition,r=this.params.expression;t<r.length;){var i=r[t];if("("!==i||this.expectingOperator){if(")"===i)return this.endPosition=t-1,0===this.startPosition&&(this.extraEndBracket=!0),t;if(" "===i);else if(this.expectingExpression){t=(o=new fe(this.params,t)).parseExpression(),this.expressionParsers.push(o),this.expectingExpression=!1,this.expectingOperator=!0}else this.expectingOperator&&(t=this.operatorParser.parseExpression(t),this.expectingOperator=!1,this.expectingExpression=!0)}else{var o;t=(o=new e(this.params,t+1)).parseExpression(),this.expressionParsers.push(o),this.expectingExpression=!1,this.expectingOperator=!0}t++}return this.startPosition>0&&(this.missingEndBracket=!0),t},e.prototype.isValid=function(){return!this.missingEndBracket&&!this.extraEndBracket&&this.expressionParsers.length===this.operatorParser.getNumOperators()+1&&this.operatorParser.isValid()&&this.expressionParsers.every((function(e){return e.isValid()}))},e.prototype.getValidationError=function(){for(var e,t=this.operatorParser.getValidationError(),r=0;r<this.expressionParsers.length;r++){var i=this.expressionParsers[r].getValidationError();if(i)return t&&t.startPosition<i.startPosition?t:i}return t||(this.extraEndBracket?{message:this.params.advancedFilterExpressionService.translate("advancedFilterValidationExtraEndBracket"),startPosition:this.endPosition+1,endPosition:this.endPosition+1}:(this.expressionParsers.length===this.operatorParser.getNumOperators()?e="advancedFilterValidationMissingCondition":this.missingEndBracket&&(e="advancedFilterValidationMissingEndBracket"),e?{message:this.params.advancedFilterExpressionService.translate(e),startPosition:this.params.expression.length,endPosition:this.params.expression.length}:null))},e.prototype.getFunction=function(e){var t=this.expressionParsers.length>1,r=this.expressionParsers.map((function(t){return t.getFunction(e)})).join(" ".concat(this.operatorParser.getFunction()," "));return t?"(".concat(r,")"):r},e.prototype.getAutocompleteListParams=function(e){if(!(null!=this.endPosition&&e>this.endPosition+1)){if(!this.expressionParsers.length)return this.getColumnAutocompleteListParams();var t=this.getExpressionParserIndex(e);if(null==t)return"("===this.params.expression[e]?{enabled:!1}:this.getColumnAutocompleteListParams();var r=this.expressionParsers[t].getAutocompleteListParams(e);if(!r){if(t<this.expressionParsers.length-1)return this.operatorParser.getAutocompleteListParams(e,t);if(this.expressionParsers.length===this.operatorParser.getNumOperators()){var i=this.operatorParser.getLastOperatorEndPosition();return null==i||e<=i+1?this.operatorParser.getAutocompleteListParams(e,this.operatorParser.getNumOperators()-1):this.getColumnAutocompleteListParams()}return")"===this.params.expression[e-1]?{enabled:!1}:this.operatorParser.getAutocompleteListParams(e)}return r}},e.prototype.updateExpression=function(e,t,r){var i,o=this.params.expression,n=this.getExpressionParserIndex(e);if(null==n){var a="column"===r?this.params.advancedFilterExpressionService.getColumnValue(t):null!==(i=t.displayValue)&&void 0!==i?i:t.key;return se(o,this.startPosition,this.startPosition,a,!0)}var s=this.expressionParsers[n].updateExpression(e,t,r);return null==s?"column"===r?se(o,e,o.length-1,this.params.advancedFilterExpressionService.getColumnValue(t),!0):null!=this.endPosition&&e>this.endPosition+1?null:this.operatorParser.updateExpression(e,t,n):s},e.prototype.getModel=function(){return this.expressionParsers.length>1?{filterType:"join",type:this.operatorParser.getModel(),conditions:this.expressionParsers.map((function(e){return e.getModel()}))}:this.expressionParsers[0].getModel()},e.prototype.getColumnAutocompleteListParams=function(){return this.params.advancedFilterExpressionService.generateAutocompleteListParams(this.params.advancedFilterExpressionService.getColumnAutocompleteEntries(),"column","")},e.prototype.getExpressionParserIndex=function(e){for(var t,r=0;r<this.expressionParsers.length;r++){if(this.expressionParsers[r].startPosition>e)break;t=r}return t},e}(),Pe=function(){function e(e){this.params=e,this.valid=!1}return e.prototype.parseExpression=function(){this.joinExpressionParser=new Oe(this.params,0);var e=this.joinExpressionParser.parseExpression();return this.valid=e>=this.params.expression.length-1&&this.joinExpressionParser.isValid(),this.params.expression},e.prototype.isValid=function(){return this.valid},e.prototype.getValidationMessage=function(){var e=this.joinExpressionParser.getValidationError();if(!e)return null;var t=e.message,r=e.startPosition,i=e.endPosition;return r<this.params.expression.length?this.params.advancedFilterExpressionService.translate("advancedFilterValidationMessage",[t,this.params.expression.slice(r,i+1).trim()]):this.params.advancedFilterExpressionService.translate("advancedFilterValidationMessageAtEnd",[t])},e.prototype.getFunction=function(){var e={operands:[],operators:[],evaluatorParams:[]};return{functionBody:"return ".concat(this.joinExpressionParser.getFunction(e),";"),params:e}},e.prototype.getAutocompleteListParams=function(e){var t;return null!==(t=this.joinExpressionParser.getAutocompleteListParams(e))&&void 0!==t?t:{enabled:!1}},e.prototype.updateExpression=function(e,t,r){return this.joinExpressionParser.updateExpression(e,t,r)},e.prototype.getModel=function(){return this.isValid()?this.joinExpressionParser.getModel():null},e}(),Te=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),De=function(e,t,r,i){var o,n=arguments.length,a=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(n<3?o(a):n>3?o(t,r,a):o(t,r))||a);return n>3&&a&&Object.defineProperty(t,r,a),a},Re=function(t){function r(){var e=null!==t&&t.apply(this,arguments)||this;return e.appliedExpression=null,e.expression=null,e.isValid=!0,e}return Te(r,t),r.prototype.postConstruct=function(){var t=this;this.setEnabled(this.gridOptionsService.get("enableAdvancedFilter"),!0),this.ctrl=this.createManagedBean(new te(this.enabled)),this.expressionProxy={getValue:function(e,r){var i=t.columnModel.getPrimaryColumn(e);return i?t.valueService.getValue(i,r,!0):void 0}},this.addManagedPropertyListener("enableAdvancedFilter",(function(e){return t.setEnabled(!!e.currentValue)})),this.addManagedListener(this.eventService,e.Events.EVENT_NEW_COLUMNS_LOADED,(function(e){return t.onNewColumnsLoaded(e)})),this.addManagedPropertyListener("includeHiddenColumnsInAdvancedFilter",(function(){return t.updateValidity()}))},r.prototype.isEnabled=function(){return this.enabled},r.prototype.isFilterPresent=function(){return!!this.expressionFunction},r.prototype.doesFilterPass=function(e){return this.expressionFunction(this.expressionProxy,e,this.expressionParams)},r.prototype.getModel=function(){var e,t=this.createExpressionParser(this.appliedExpression);return null==t||t.parseExpression(),null!==(e=null==t?void 0:t.getModel())&&void 0!==e?e:null},r.prototype.setModel=function(t){var r=this,i=function(t,o){if("join"===t.filterType){var n=r.advancedFilterExpressionService.parseJoinOperator(t),a=t.conditions.map((function(e){return i(e)})).filter((function(t){return e._.exists(t)})).join(" ".concat(n," "));return o||t.conditions.length<=1?a:"(".concat(a,")")}return r.advancedFilterExpressionService.parseColumnFilterModel(t)},o=t?i(t,!0):null;this.setExpressionDisplayValue(o),this.applyExpression(),this.ctrl.refreshComp(),this.ctrl.refreshBuilderComp()},r.prototype.getExpressionDisplayValue=function(){return this.expression},r.prototype.setExpressionDisplayValue=function(e){this.expression=e},r.prototype.isCurrentExpressionApplied=function(){return this.appliedExpression===this.expression},r.prototype.createExpressionParser=function(e){return e?new Pe({expression:e,columnModel:this.columnModel,dataTypeService:this.dataTypeService,valueParserService:this.valueParserService,advancedFilterExpressionService:this.advancedFilterExpressionService}):null},r.prototype.getDefaultExpression=function(e){var t=this.advancedFilterExpressionService.getColumnValue(e)+" ";return{updatedValue:t,updatedPosition:t.length}},r.prototype.isHeaderActive=function(){return!this.gridOptionsService.get("advancedFilterParent")},r.prototype.getCtrl=function(){return this.ctrl},r.prototype.setEnabled=function(t,r){var i=this.enabled,o=this.rowModel.getType(),n="clientSide"===o||"serverSide"===o;if(t&&!o&&e._.warnOnce("Advanced Filter is only supported with the Client-Side Row Model or Server-Side Row Model."),this.enabled=t&&n,!r&&this.enabled!==i){var a={type:e.Events.EVENT_ADVANCED_FILTER_ENABLED_CHANGED,enabled:this.enabled};this.eventService.dispatchEvent(a)}},r.prototype.applyExpression=function(){var e=this.createExpressionParser(this.expression);null==e||e.parseExpression(),this.applyExpressionFromParser(e)},r.prototype.applyExpressionFromParser=function(e){if(this.isValid=!e||e.isValid(),!e||!this.isValid)return this.expressionFunction=null,this.expressionParams=null,void(this.appliedExpression=null);var t=e.getFunction(),r=t.functionBody,i=t.params;this.expressionFunction=new Function("expressionProxy","node","params",r),this.expressionParams=i,this.appliedExpression=this.expression},r.prototype.updateValidity=function(){this.advancedFilterExpressionService.resetColumnCaches();var e=this.createExpressionParser(this.expression);null==e||e.parseExpression();var t=(!e||e.isValid())!==this.isValid;return this.applyExpressionFromParser(e),this.ctrl.refreshComp(),this.ctrl.refreshBuilderComp(),t},r.prototype.onNewColumnsLoaded=function(t){var r=this;if("gridInitializing"===t.source&&this.dataTypeService.isPendingInference()){this.ctrl.setInputDisabled(!0);var i=this.addManagedListener(this.eventService,e.Events.EVENT_DATA_TYPES_INFERRED,(function(){null==i||i(),r.ctrl.setInputDisabled(!1)}))}},De([e.Autowired("valueService")],r.prototype,"valueService",void 0),De([e.Autowired("columnModel")],r.prototype,"columnModel",void 0),De([e.Autowired("dataTypeService")],r.prototype,"dataTypeService",void 0),De([e.Autowired("valueParserService")],r.prototype,"valueParserService",void 0),De([e.Autowired("rowModel")],r.prototype,"rowModel",void 0),De([e.Autowired("advancedFilterExpressionService")],r.prototype,"advancedFilterExpressionService",void 0),De([e.PostConstruct],r.prototype,"postConstruct",null),r=De([e.Bean("advancedFilterService")],r)}(e.BeanStub),Me={version:"31.0.3",moduleName:e.ModuleNames.AdvancedFilterModule,beans:[Re,Ee],agStackComponents:[{componentName:"agAdvancedFilter",componentClass:oe}],dependantModules:[h]},_e=Object.defineProperty,ke=Object.defineProperties,Le=Object.getOwnPropertyDescriptor,Fe=Object.getOwnPropertyDescriptors,Ie=Object.getOwnPropertySymbols,Ne=Object.getPrototypeOf,Ge=Object.prototype.hasOwnProperty,Be=Object.prototype.propertyIsEnumerable,Ve=Reflect.get,je=(e,t)=>(t=Symbol[e])?t:Symbol.for("Symbol."+e),Ue=Math.pow,He=(e,t,r)=>t in e?_e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,We=(e,t)=>{for(var r in t||(t={}))Ge.call(t,r)&&He(e,r,t[r]);if(Ie)for(var r of Ie(t))Be.call(t,r)&&He(e,r,t[r]);return e},ze=(e,t)=>ke(e,Fe(t)),Ke=(e,t)=>{var r={};for(var i in e)Ge.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&Ie)for(var i of Ie(e))t.indexOf(i)<0&&Be.call(e,i)&&(r[i]=e[i]);return r},Ye=(e,t)=>{for(var r in t)_e(e,r,{get:t[r],enumerable:!0})},Xe=(e,t,r,i)=>{for(var o,n=i>1?void 0:i?Le(t,r):t,a=e.length-1;a>=0;a--)(o=e[a])&&(n=(i?o(t,r,n):o(n))||n);return i&&n&&_e(t,r,n),n},qe=(e,t,r)=>Ve(Ne(e),r,t),$e=(e,t,r)=>new Promise((i,o)=>{var n=e=>{try{s(r.next(e))}catch(e){o(e)}},a=e=>{try{s(r.throw(e))}catch(e){o(e)}},s=e=>e.done?i(e.value):Promise.resolve(e.value).then(n,a);s((r=r.apply(e,t)).next())}),Ze=function(e,t){this[0]=e,this[1]=t},Je=e=>{var t,r=e[je("asyncIterator")],i=!1,o={};return null==r?(r=e[je("iterator")](),t=e=>o[e]=t=>r[e](t)):(r=r.call(e),t=e=>o[e]=t=>{if(i){if(i=!1,"throw"===e)throw t;return t}return i=!0,{done:!1,value:new Ze(new Promise(i=>{var o=r[e](t);if(!(o instanceof Object))throw TypeError("Object expected");i(o)}),1)}}),o[je("iterator")]=()=>o,t("next"),"throw"in r?t("throw"):o.throw=e=>{throw e},"return"in r&&t("return"),o},Qe={};Ye(Qe,{day:()=>ht,friday:()=>St,hour:()=>dt,millisecond:()=>rt,minute:()=>lt,monday:()=>vt,month:()=>Et,saturday:()=>xt,second:()=>nt,sunday:()=>yt,thursday:()=>bt,tuesday:()=>mt,utcDay:()=>Rt,utcHour:()=>Dt,utcMinute:()=>Tt,utcMonth:()=>Mt,utcYear:()=>_t,wednesday:()=>Ct,year:()=>Ot});var et=class{constructor(e,t,r){this._encode=e,this._decode=t,this._rangeCallback=r}floor(e){const t=new Date(e),r=this._encode(t);return this._decode(r)}ceil(e){const t=new Date(Number(e)-1),r=this._encode(t);return this._decode(r+1)}range(e,t,r){var i;const o=null==(i=this._rangeCallback)?void 0:i.call(this,e,t),n=this._encode(r?this.floor(e):this.ceil(e)),a=this._encode(r?this.ceil(t):this.floor(t));if(a<n)return[];const s=[];for(let e=n;e<=a;e++){const t=this._decode(e);s.push(t)}return null==o||o(),s}},tt=class extends et{getOffset(e,t){const r="number"==typeof e||e instanceof Date?this._encode(new Date(e)):0;return Math.floor(r)%t}every(e,t){let r,i=0;const{snapTo:o="start"}=null!=t?t:{};if("string"==typeof o){const t=i;r=(r,n)=>{const a="start"===o?r:n;return i=this.getOffset(a,e),()=>i=t}}else"number"==typeof o?i=this.getOffset(new Date(o),e):o instanceof Date&&(i=this.getOffset(o,e));return new et(t=>{const r=this._encode(t);return Math.floor((r-i)/e)},t=>this._decode(t*e+i),r)}};var rt=new tt((function(e){return e.getTime()}),(function(e){return new Date(e)})),it=rt,ot=(new Date(0).getFullYear(),6e4*(new Date).getTimezoneOffset());var nt=new tt((function(e){return Math.floor((e.getTime()-ot)/1e3)}),(function(e){return new Date(ot+1e3*e)})),at=nt,st=6e4*(new Date).getTimezoneOffset();var lt=new tt((function(e){return Math.floor((e.getTime()-st)/6e4)}),(function(e){return new Date(st+6e4*e)})),ct=lt,ut=6e4*(new Date).getTimezoneOffset();var dt=new tt((function(e){return Math.floor((e.getTime()-ut)/36e5)}),(function(e){return new Date(ut+36e5*e)})),pt=dt;var ht=new tt((function(e){const t=6e4*e.getTimezoneOffset();return Math.floor((e.getTime()-t)/864e5)}),(function(e){const t=new Date(1970,0,1);return t.setDate(t.getDate()+e),t})),ft=ht;function gt(e){const t=(7+e-4)%7;return new tt((function(e){const r=6e4*e.getTimezoneOffset();return Math.floor((e.getTime()-r)/6048e5-t/7)}),(function(e){const r=new Date(1970,0,1);return r.setDate(r.getDate()+7*e+t),r}))}var yt=gt(0),vt=gt(1),mt=gt(2),Ct=gt(3),bt=gt(4),St=gt(5),xt=gt(6),wt=yt;var Et=new tt((function(e){return 12*e.getFullYear()+e.getMonth()}),(function(e){const t=Math.floor(e/12);return new Date(t,e-12*t,1)})),At=Et;var Ot=new tt((function(e){return e.getFullYear()}),(function(e){const t=new Date;return t.setFullYear(e),t.setMonth(0,1),t.setHours(0,0,0,0),t})),Pt=Ot;var Tt=new tt((function(e){return Math.floor(e.getTime()/6e4)}),(function(e){return new Date(6e4*e)}));var Dt=new tt((function(e){return Math.floor(e.getTime()/36e5)}),(function(e){return new Date(36e5*e)}));var Rt=new tt((function(e){return Math.floor(e.getTime()/864e5)}),(function(e){const t=new Date(0);return t.setUTCDate(t.getUTCDate()+e),t.setUTCHours(0,0,0,0),t}));var Mt=new tt((function(e){return 12*e.getUTCFullYear()+e.getUTCMonth()}),(function(e){const t=Math.floor(e/12),r=e-12*t;return new Date(Date.UTC(t,r,1))}));var _t=new tt((function(e){return e.getUTCFullYear()}),(function(e){const t=new Date;return t.setUTCFullYear(e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0),t})),kt={isEnterprise:!1},Lt=class{constructor(){this.destroyFns=[]}destroy(){for(const e of this.destroyFns)e()}},Ft=[];function It(e){const t=Ft.find(t=>e.type===t.type&&e.optionsKey===t.optionsKey&&e.identifier===t.identifier);if(t){if("enterprise"===e.packageType&&"community"===t.packageType){const r=Ft.indexOf(t);Ft.splice(r,1,e)}}else Ft.push(e)}function Nt(){return Ft.some(e=>"enterprise"===e.packageType)}var Gt=new Map;function Bt(e,t){Gt.set(e,t)}function Vt(e){const{length:t}=e;if(0===t)return;let r=1/0,i=-1/0;for(let o=0;o<t;o++){let t=e[o];t instanceof Date&&(t=t.getTime()),"number"==typeof t&&(t<r&&(r=t),t>i&&(i=t))}const o=[r,i];return o.some(e=>!isFinite(e))?void 0:o}function jt(e,t,r){return Ut(e,t,r).extent}function Ut(e,t,r){var i;let o=!1;return e.length>2&&(e=null!=(i=Vt(e))?i:[NaN,NaN]),isNaN(t)||(o||(o=t>e[0]),e=[t,e[1]]),isNaN(r)||(o||(o=r<e[1]),e=[e[0],r]),e[0]>e[1]&&(e=[]),{extent:e,clipped:o}}function Ht(e,t){if(null==e||null==t||e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(Array.isArray(e[r])&&Array.isArray(t[r])){if(!Ht(e[r],t[r]))return!1}else if(e[r]!==t[r])return!1;return!0}function Wt(e){return void 0===e?[]:Array.isArray(e)?e:[e]}function zt(e){return Array.from(new Set(e))}var Kt={};function Yt(e,t){Kt[t]||(e(),Kt[t]=!0)}var Xt={log(...e){console.log(...e)},warn(e,...t){console.warn("AG Charts - "+e,...t)},error(e,...t){"object"==typeof e?console.error("AG Charts error",e,...t):console.error("AG Charts - "+e,...t)},table(...e){console.table(...e)},warnOnce(e,...t){Yt(()=>Xt.warn(e,...t),"Logger.warn: "+e)},errorOnce(e,...t){Yt(()=>Xt.error(e,...t),"Logger.error: "+e)}};function qt(e){const t="undefined"!=typeof window?window:void 0;return null==t?void 0:t[e]}var $t=Date.now(),Zt={create:(...e)=>(...t)=>{Zt.check(...e)&&("function"==typeof t[0]&&(t=Wt(t[0]())),(()=>{const e=Date.now()-$t;if(e>2e3){const t=(Math.floor(e/100)/10).toFixed(1);Xt.log(`**** ${t}s since last log message ****`)}$t=Date.now()})(),Xt.log(...t))},check(...e){0===e.length&&e.push(!0);return Wt(qt("agChartsDebug")).some(t=>e.includes(t))}},Jt=Symbol("BREAK"),Qt="__decorator_config";function er(e,t,r){return(i,o)=>{const n=function(e,t){null==Object.getOwnPropertyDescriptor(e,Qt)&&Object.defineProperty(e,Qt,{value:{}});const r=e[Qt],i=t.toString();if(void 0!==r[i])return r[i];const o=new WeakMap;r[i]={setters:[],getters:[],valuesMap:o};const n=Object.getOwnPropertyDescriptor(e,t),a=null==n?void 0:n.set,s=null==n?void 0:n.get;return Object.defineProperty(e,t,{set:function(e){const{setters:n}=r[i];let l;n.some(e=>e.length>2)&&(l=s?s.call(this):o.get(this));for(const r of n)if((e=r(this,t,e,l))===Jt)return;a?a.call(this,e):o.set(this,e)},get:function(){let e=s?s.call(this):o.get(this);for(const o of r[i].getters)if(e=o(this,t,e),e===Jt)return;return e},enumerable:!0,configurable:!1}),r[i]}(i,o);n.setters.push(e),t&&n.getters.unshift(t),r&&Object.assign(n,r)}}function tr(e){return void 0!==e&&Qt in e}function rr(e){const t=new Set;for(;tr(e);)t.add(null==e?void 0:e[Qt]),e=Object.getPrototypeOf(e);return Array.from(t).flatMap(e=>Object.keys(e))}function ir(e){return rr(e).reduce((t,r)=>{var i;return t[r]=null!=(i=e[r])?i:null,t},{})}function or(){return(e,t)=>{const r=[`Property [${e}] is deprecated.`,t].filter(Boolean).join(" ");Xt.warnOnce(r)}}function nr(e,t){const r=or(),i=null==t?void 0:t.default;return er((t,o,n)=>(n!==i&&r(o.toString(),e),n))}function ar(e,t){const r=or();return er((i,o,n)=>(n!==i[e]&&(r(o.toString(),`Use [${e}] instead.`),i[e]=t?t(n):n),Jt),(t,i)=>(r(i.toString(),`Use [${e}] instead.`),t[e]))}var sr=(e=>(e[e.NONE=0]="NONE",e[e.TRIVIAL=1]="TRIVIAL",e[e.MINOR=2]="MINOR",e[e.MAJOR=3]="MAJOR",e))(sr||{});var lr=function(){try{return new Function("return true"),!0}catch(e){return!1}}();function cr(e){const{changeCb:t,convertor:r}=null!=e?e:{};return function(i,o){const n="__"+o;i[o]||(lr&&null==t&&null==r?function(e,t,r,i){const{redraw:o=1,type:n="normal",checkDirtyOnAssignment:a=!1}=null!=i?i:{},s=new Function("value",`\n        const oldValue = this.${r};\n        if (value !== oldValue) {\n            this.${r} = value;\n            ${"normal"===n?`this.markDirty(this, ${o});`:""}\n            ${"transform"===n?`this.markDirtyTransform(${o});`:""}\n            ${"path"===n?`if (!this._dirtyPath) { this._dirtyPath = true; this.markDirty(this, ${o}); }`:""}\n            ${"font"===n?`if (!this._dirtyFont) { this._dirtyFont = true; this.markDirty(this, ${o}); }`:""}\n        }\n        ${a?"if (value != null && value._dirty > 0) { this.markDirty(value, value._dirty); }":""}\n`),l=new Function(`return this.${r};`);Object.defineProperty(e,t,{set:s,get:l,enumerable:!0,configurable:!0})}(i,o,n,e):function(e,t,r,i){const{redraw:o=1,type:n="normal",changeCb:a,convertor:s,checkDirtyOnAssignment:l=!1}=null!=i?i:{};Object.defineProperty(e,t,{set:function(e){const t=this[r];(e=s?s(e):e)!==t&&(this[r]=e,"normal"===n&&this.markDirty(this,o),"transform"===n&&this.markDirtyTransform(o),"path"!==n||this._dirtyPath||(this._dirtyPath=!0,this.markDirty(this,o)),"font"!==n||this._dirtyFont||(this._dirtyFont=!0,this.markDirty(this,o)),a&&a(this)),l&&null!=e&&e._dirty>0&&this.markDirty(e,e._dirty)},get:function(){return this[r]},enumerable:!0,configurable:!0})}(i,o,n,e))}}var ur=class{constructor(){this._dirty=3}markDirty(e,t=1){this._dirty>t||(this._dirty=t)}markClean(e){this._dirty=0}isDirty(){return this._dirty>0}};function dr(e){return null!=e}function pr(e){return Array.isArray(e)}function hr(e){return"boolean"==typeof e}function fr(e){return e instanceof Date}function gr(e){return fr(e)&&!isNaN(Number(e))}function yr(e){return"function"==typeof e}function vr(e){return"object"==typeof e&&null!==e&&!pr(e)}function mr(e){return"object"==typeof e&&null!==e}function Cr(e){return"object"==typeof e&&null!==e&&e.constructor===Object}function br(e){return"string"==typeof e}function Sr(e){return"number"==typeof e}function xr(e){return Sr(e)&&Number.isFinite(e)}function wr(e){return"undefined"!=typeof window&&e instanceof HTMLElement}var Er=class extends ur{constructor(e){super(),this.className=e}set(e){const t=new Set(Object.keys(e));for(const r of rr(this))if(t.has(r)){const i=e[r],o=this;Or(o[r])?o[r]=o[r]instanceof Ar?o[r].reset(i):o[r].set(i):o[r]=i,t.delete(r)}for(const e of t){const{className:t=this.constructor.name}=this;Xt.warn(`unable to set [${e}] in ${t} - property is unknown`)}return this}isValid(){return rr(this).every(e=>{const{optional:t}=function(e,t){const r=t.toString();for(;tr(e);){const t=e[Qt];if(Object.hasOwn(t,r))return t[r];e=Object.getPrototypeOf(e)}}(this,e);return t||void 0!==this[e]})}toJson(){return rr(this).reduce((e,t)=>(e[t]=this[t],e),{})}},Ar=class e extends Array{constructor(e,...t){super(t.length),Object.defineProperty(this,"itemFactory",{value:e,enumerable:!1,configurable:!1}),this.set(t)}set(e){if(pr(e)){this.length=e.length;for(let t=0;t<e.length;t++)this[t]=(new this.itemFactory).set(e[t])}return this}reset(t){return new e(this.itemFactory,...t)}};function Or(e){return e instanceof Er||e instanceof Ar}function Pr(e,t){if(pr(t)){if(!pr(e)||e.length!==t.length||t.some((t,r)=>null!=Pr(e[r],t)))return t}else{if(vr(t)){if(!vr(e)||!Cr(t))return t;const r={},i=new Set([...Object.keys(e),...Object.keys(t)]);for(const o of i)if(e[o]!==t[o])if(typeof e[o]!=typeof t[o])r[o]=t[o];else{const i=Pr(e[o],t[o]);null!==i&&(r[o]=i)}return Object.keys(r).length?r:null}if(e!==t)return t}return null}function Tr(e){return pr(e)?e.map(Tr):Cr(e)?Object.entries(e).reduce((e,[t,r])=>(e[t]=Tr(r),e),{}):e}var Dr=Symbol("<delete-property>"),Rr=Symbol("<unspecified-property>");function Mr(e,t){var r;const i=null!=(r=null==t?void 0:t.avoidDeepClone)?r:[];if(e.map(e=>Fr(e)).some(e=>"array"===e)){const r=e[e.length-1];return Array.isArray(r)?r.map(e=>{const r=Fr(e);return"array"===r?Mr([[],e],t):"object"===r?Mr([{},e],t):e}):r}const o={},n=new Set(e.map(e=>null!=e?Object.keys(e):[]).reduce((e,t)=>e.concat(t),[]));for(const r of n){const n=e.map(e=>null!=e&&"object"==typeof e&&r in e?e[r]:Rr).filter(e=>e!==Rr);if(0===n.length)continue;const a=n[n.length-1];if(a===Dr)continue;const s=n.map(e=>Fr(e)),l=s[0];s.some(e=>e!==l)?o[r]=a:"array"!==l&&"object"!==l||i.includes(r)?o[r]="array"===l?[...a]:a:o[r]=Mr(n,t)}return o}function _r(e,t,r={}){var i,o,n;const{path:a,matcherPath:s=(a?a.replace(/(\[[0-9+]+])/i,"[]"):void 0),skip:l=[],constructors:c={},constructedArrays:u=new WeakMap,allowedTypes:d={},idx:p}=r;if(null==e)throw new Error("AG Charts - target is uninitialised: "+(null!=a?a:"<root>"));if(null==t)return e;if(Or(e))return e.set(t);const h=e;null!=p&&"_declarationOrder"in h&&(h._declarationOrder=p);const f=Fr(e);for(const p in t){const g=`${s?s+".":""}${p}`;if(l.indexOf(g)>=0)continue;const y=t[p],v=`${a?a+".":""}${p}`,m=h.constructor,C=h[p];let b=null!=(i=c[g])?i:c[p];try{const t=Fr(C),i=Fr(y);if("class-instance"===f&&!(p in e)&&!Object.hasOwn(h,p)){Xt.warn(`unable to set [${v}] in ${null==m?void 0:m.name} - property is unknown`);continue}const a=null!=(o=d[g])?o:[t];if("class-instance"===t&&"object"===i);else if(null!=t&&null!=i&&!a.includes(i)){Xt.warn(`unable to set [${v}] in ${null==m?void 0:m.name} - can't apply type of [${i}], allowed types are: [${a}]`);continue}if("array"===i)if(b=null!=(n=null!=b?b:u.get(C))?n:c[g+"[]"],Or(h[p]))h[p].set(y);else if(null!=b){const e=y;h[p]=e.map((e,t)=>_r(new b,e,ze(We({},r),{path:v,matcherPath:g+"[]",idx:t})))}else h[p]=y;else if("class-instance"===i)h[p]=y;else if("object"===i)if(null!=C)_r(C,y,ze(We({},r),{path:v,matcherPath:g,idx:void 0}));else if(Or(h[p]))h[p].set(y);else if(null!=b){const e=new b;Or(e)?h[p]=e.set(y):h[p]=_r(e,y,ze(We({},r),{path:v,matcherPath:g,idx:void 0}))}else h[p]=y;else Or(h[p])?h[p].set(y):h[p]=y}catch(e){Xt.warn(`unable to set [${v}] in [${null==m?void 0:m.name}]; nested error is: ${e.message}`)}}return e}function kr(e,t,r,...i){var o;if(pr(e))t(e,...i),e.forEach((e,o)=>{kr(e,t,r,...Lr(i,o))});else if(Cr(e)){t(e,...i);for(const n of Object.keys(e)){if(null==(o=null==r?void 0:r.skip)?void 0:o.includes(n))continue;const a=e[n];(pr(a)||Cr(a))&&kr(a,t,r,...Lr(i,n))}}}function Lr(e,t){return e.map(e=>null==e?void 0:e[t])}function Fr(e){return null==e?null:wr(e)||fr(e)?"primitive":pr(e)?"array":vr(e)?Cr(e)?"object":"class-instance":yr(e)?"function":"primitive"}var Ir=2*Math.PI;function Nr(e){return e%=Ir,e+=Ir,e%=Ir}function Gr(e){return e%=Ir,(e+=Ir)!==Ir&&(e%=Ir),e}function Br(e){return(e%=Ir)<-Math.PI?e+=Ir:e>=Math.PI&&(e-=Ir),e}function Vr(e){return e/180*Math.PI}function jr(e){return e/Math.PI*180}function Ur(e,t){return e=Nr(e),(t=Nr(t))-e+(e>t?2*Math.PI:0)}var Hr=(e,t)=>{const r=Symbol(String(t));e[r]=void 0,Object.defineProperty(e,t,{get(){return this[r]},set(e){this[r]!==e&&(this[r]=e,this.invalid=!0)},enumerable:!0,configurable:!1})};function Wr(e,t,r){return Math.max(t,Math.min(r,e))}var zr=class{constructor(){this.type="band",this.invalid=!0,this.interval=1,this.index=new Map,this.ordinalRange=[],this._domain=[],this.range=[0,1],this._bandwidth=1,this._step=1,this._rawBandwidth=1,this._paddingInner=0,this._paddingOuter=0,this.round=!1}refresh(){this.invalid&&(this.invalid=!1,this.update(),this.invalid&&Xt.warnOnce("Expected update to not invalidate scale"))}set domain(e){this.invalid=!0;const t=[];this.index=new Map;const r=this.index;e.forEach(e=>{void 0===r.get(e)&&r.set(e,t.push(e)-1)}),this._domain=t}get domain(){return this._domain}ticks(){this.refresh();const{interval:e=1}=this,t=Math.abs(Math.round(e));return this._domain.filter((e,r)=>r%t==0)}convert(e){this.refresh();const t=this.index.get(e);if(void 0===t)return NaN;const r=this.ordinalRange[t];return void 0===r?NaN:r}invert(e){this.refresh();const t=this.ordinalRange.findIndex(t=>t===e);return this.domain[t]}get bandwidth(){return this.refresh(),this._bandwidth}get step(){return this.refresh(),this._step}get rawBandwidth(){return this.refresh(),this._rawBandwidth}set padding(e){e=Wr(e,0,1),this._paddingInner=e,this._paddingOuter=e}get padding(){return this._paddingInner}set paddingInner(e){this._paddingInner=Wr(e,0,1)}get paddingInner(){return this._paddingInner}set paddingOuter(e){this._paddingOuter=Wr(e,0,1)}get paddingOuter(){return this._paddingOuter}update(){const e=this._domain.length;if(0===e)return;const t=this.round,r=this._paddingInner,i=this._paddingOuter,[o,n]=this.range,a=n-o,s=a/Math.max(1,e+2*i-r),l=t?Math.floor(s):s,c=o+(a-l*(e-r))/2,u=t?Math.round(c):c,d=l*(1-r),p=t?Math.round(d):d,h=s*(1-r),f=[];for(let t=0;t<e;t++)f.push(u+l*t);this._bandwidth=p,this._rawBandwidth=h,this._step=l,this.ordinalRange=f}};function Kr(e,t,r){return Math.min(r,Math.max(e,t))}function Yr(e,t){return Kr(Math.min(...t),e,Math.max(...t))}function Xr(e,t,r=1e-10){return Math.abs(e-t)<r}function qr(e){return Math.sign(e)<0||Object.is(e,-0)}function $r(e){return isFinite(e)&&!isNaN(e)}function Zr(e,t=2){const r=Math.pow(10,t);return Math.round(e*r)/r}function Jr(e,t=2){const r=Math.floor(Math.log(Math.abs(e))/Math.LN10);return r>=0||!isFinite(r)?e.toFixed(t):e.toFixed(Math.abs(r)-1+t)}function Qr(e){return $r(e)?e:0}function ei(e,t){return e>=0?Math.floor(e%t):Math.floor(e%t+t)}Xe([Hr],zr.prototype,"interval",2),Xe([Hr],zr.prototype,"range",2),Xe([Hr],zr.prototype,"round",2);var ti=(e,t=10)=>{const r=(Math.abs(e)%1).toFixed(t);for(let e=r.length-1;e>=2;e-=1)if("0"!==r[e])return t-(r.length-1-e);return 0},ri=e=>{const t=e<0?-1:1,r=Math.abs(e);return r<=.04045?e/12.92:t*Ue((r+.055)/1.055,2.4)},ii=e=>{const t=e<0?-1:1,r=Math.abs(e);return r>.0031308?t*(1.055*Ue(r,1/2.4)-.055):12.92*e},oi=class e{constructor(e,t,r,i=1){this.r=Kr(0,e||0,1),this.g=Kr(0,t||0,1),this.b=Kr(0,r||0,1),this.a=Kr(0,i||0,1)}static validColorString(t){return t.indexOf("#")>=0?!!e.parseHex(t):t.indexOf("rgb")>=0?!!e.stringToRgba(t):!!e.nameToHex[t.toLowerCase()]}static fromString(t){if(t.indexOf("#")>=0)return e.fromHexString(t);const r=e.nameToHex[t.toLowerCase()];if(r)return e.fromHexString(r);if(t.indexOf("rgb")>=0)return e.fromRgbaString(t);throw new Error(`Invalid color string: '${t}'`)}static tryParseFromString(t){try{return e.fromString(t)}catch(r){return Xt.warnOnce(`invalid color string: '${t}'.`),e.fromArray([0,0,0])}}static parseHex(e){let t;switch((e=e.replace(/ /g,"").slice(1)).length){case 6:case 8:t=[];for(let r=0;r<e.length;r+=2)t.push(parseInt(`${e[r]}${e[r+1]}`,16));break;case 3:case 4:t=e.split("").map(e=>parseInt(e,16)).map(e=>e+16*e)}if((null==t?void 0:t.length)>=3&&t.every(e=>e>=0))return 3===t.length&&t.push(255),t}static fromHexString(t){const r=e.parseHex(t);if(r){const[t,i,o,n]=r;return new e(t/255,i/255,o/255,n/255)}throw new Error(`Malformed hexadecimal color string: '${t}'`)}static stringToRgba(e){let[t,r]=[NaN,NaN];for(let i=0;i<e.length;i++){const o=e[i];if(t||"("!==o){if(")"===o){r=i;break}}else t=i}const i=t&&r&&e.substring(t+1,r);if(!i)return;const o=i.split(","),n=[];for(let e=0;e<o.length;e++){const t=o[e];let r=parseFloat(t);if(isNaN(r))return;t.indexOf("%")>=0?(r=Math.max(0,Math.min(100,r)),r/=100):3===e?r=Math.max(0,Math.min(1,r)):(r=Math.max(0,Math.min(255,r)),r/=255),n.push(r)}return n}static fromRgbaString(t){const r=e.stringToRgba(t);if(r){if(3===r.length)return new e(r[0],r[1],r[2]);if(4===r.length)return new e(r[0],r[1],r[2],r[3])}throw new Error(`Malformed rgb/rgba color string: '${t}'`)}static fromArray(t){if(4===t.length)return new e(t[0],t[1],t[2],t[3]);if(3===t.length)return new e(t[0],t[1],t[2]);throw new Error("The given array should contain 3 or 4 color components (numbers).")}static fromHSB(t,r,i,o=1){const n=e.HSBtoRGB(t,r,i);return new e(n[0],n[1],n[2],o)}static fromHSL(t,r,i,o=1){const n=e.HSLtoRGB(t,r,i);return new e(n[0],n[1],n[2],o)}static fromOKLCH(t,r,i,o=1){const n=e.OKLCHtoRGB(t,r,i);return new e(n[0],n[1],n[2],o)}static padHex(e){return 1===e.length?"0"+e:e}toHexString(){let t="#"+e.padHex(Math.round(255*this.r).toString(16))+e.padHex(Math.round(255*this.g).toString(16))+e.padHex(Math.round(255*this.b).toString(16));return this.a<1&&(t+=e.padHex(Math.round(255*this.a).toString(16))),t}toRgbaString(e=3){const t=[Math.round(255*this.r),Math.round(255*this.g),Math.round(255*this.b)],r=Math.pow(10,e);return 1!==this.a?(t.push(Math.round(this.a*r)/r),`rgba(${t.join(", ")})`):`rgb(${t.join(", ")})`}toString(){return 1===this.a?this.toHexString():this.toRgbaString()}toHSB(){return e.RGBtoHSB(this.r,this.g,this.b)}static RGBtoOKLCH(e,t,r){const i=ri(e),o=ri(t),n=ri(r),a=Math.cbrt(.4122214708*i+.5363325363*o+.0514459929*n),s=Math.cbrt(.2119034982*i+.6806995451*o+.1073969566*n),l=Math.cbrt(.0883024619*i+.2817188376*o+.6299787005*n),c=.2104542553*a+.793617785*s-.0040720468*l,u=1.9779984951*a-2.428592205*s+.4505937099*l,d=.0259040371*a+.7827717662*s-.808675766*l,p=180*Math.atan2(d,u)/Math.PI;return[c,Math.hypot(u,d),p>=0?p:p+360]}static OKLCHtoRGB(e,t,r){const i=e,o=t*Math.cos(r*Math.PI/180),n=t*Math.sin(r*Math.PI/180),a=Ue(i+.3963377774*o+.2158037573*n,3),s=Ue(i-.1055613458*o-.0638541728*n,3),l=Ue(i-.0894841775*o-1.291485548*n,3),c=-1.2684380046*a+2.6097574011*s-.3413193965*l,u=-.0041960863*a-.7034186147*s+1.707614701*l;return[ii(4.0767416621*a-3.3077115913*s+.2309699292*l),ii(c),ii(u)]}static RGBtoHSL(e,t,r){const i=Math.min(e,t,r),o=Math.max(e,t,r),n=(o+i)/2;let a,s;if(o===i)a=NaN,s=0;else{const l=o-i;s=n>.5?l/(2-o-i):l/(o+i),a=o===e?(t-r)/l+(t<r?6:0):o===t?(r-e)/l+2:(e-t)/l+4,a*=60}return[a,s,n]}static HSLtoRGB(e,t,r){if(0===t)return[r,r,r];const i=r<.5?r*(1+t):r+t-r*t,o=2*r-i;function n(e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?o+6*(i-o)*e:e<.5?i:e<2/3?o+(i-o)*(2/3-e)*6:o}return[n(e/360+1/3),n(e/360),n(e/360-1/3)]}static RGBtoHSB(e,t,r){const i=Math.min(e,t,r),o=Math.max(e,t,r);let n=NaN;if(i!==o){const a=o-i,s=(o-e)/a,l=(o-t)/a,c=(o-r)/a;n=e===o?c-l:t===o?2+s-c:4+l-s,n/=6,n<0&&(n+=1)}return[360*n,0!==o?(o-i)/o:0,o]}static HSBtoRGB(e,t,r){isNaN(e)&&(e=0),e=(e%360+360)%360/360;let i=0,o=0,n=0;if(0===t)i=o=n=r;else{const a=6*(e-Math.floor(e)),s=a-Math.floor(a),l=r*(1-t),c=r*(1-t*s),u=r*(1-t*(1-s));switch(a>>0){case 0:i=r,o=u,n=l;break;case 1:i=c,o=r,n=l;break;case 2:i=l,o=r,n=u;break;case 3:i=l,o=c,n=r;break;case 4:i=u,o=l,n=r;break;case 5:i=r,o=l,n=c}}return[i,o,n]}derive(t,r,i,o){const n=e.RGBtoHSB(this.r,this.g,this.b);let a=n[2];0==a&&i>1&&(a=.05);const s=((n[0]+t)%360+360)%360,l=Math.max(Math.min(n[1]*r,1),0);a=Math.max(Math.min(a*i,1),0);const c=Math.max(Math.min(this.a*o,1),0),u=e.HSBtoRGB(s,l,a);return u.push(c),e.fromArray(u)}brighter(){return this.derive(0,1,1/.7,1)}darker(){return this.derive(0,1,.7,1)}static interpolate(t,r){const i=e.tryParseFromString(t),o=e.tryParseFromString(r);return t=>{const r=(e,r)=>e*(1-t)+r*t;return new e(r(i.r,o.r),r(i.g,o.g),r(i.b,o.b),r(i.a,o.a)).toString()}}};oi.didDebug=!1,oi.nameToHex=Object.freeze({aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgreen:"#006400",darkgrey:"#A9A9A9",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",green:"#008000",greenyellow:"#ADFF2F",grey:"#808080",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgreen:"#90EE90",lightgrey:"#D3D3D3",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",transparent:"#00000000",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"});var ni=oi;function ai(e,t={}){const{optional:r=!1}=t;return er((i,o,n)=>{var a;const s=ze(We({},t),{target:i,property:o});if(r&&void 0===n||e(n,s))return Or(i[o])&&!Or(n)?(i[o].set(n),i[o]):n;const l=String(o).replace(/^_*/,""),c=null!=(a=i.constructor.className)?a:i.constructor.name.replace(/Properties$/,"");return Xt.warn(`Property [${l}] of [${c}] cannot be set to [${Qi(n)}]${e.message?"; expecting "+Ji(e,s):""}, ignoring.`),Jt},void 0,{optional:r})}var si,li=(...e)=>{const t=[];return Zi((r,i)=>(t.length=0,e.every(e=>{const o=e(r,i);return o||t.push(Ji(e,i)),o})),()=>t.filter(Boolean).join(" AND "))},ci=(...e)=>Zi((t,r)=>e.some(e=>e(t,r)),t=>e.map(function(e){return t=>Ji(t,e)}(t)).filter(Boolean).join(" OR ")),ui=(si=Zi((e,t)=>Or(e)||vr(e)&&Or(t.target[t.property]),"an object"),Object.assign(si,{restrict(e){const t=t=>Or(t)&&t instanceof e;return Zi((e,r)=>t(e)||vr(e)&&t(r.target[r.property]),e=>{var t;return null!=(t=Ji(si,e))?t:"an object"})}})),di=Zi(hr,"a boolean"),pi=Zi(yr,"a function"),hi=Zi(br,"a string"),fi=function(e){return Object.assign(e,{restrict({min:e,max:t}={}){const r=["a number"],i=Sr(e),o=Sr(t);return i&&o?r.push(`between ${e} and ${t} inclusive`):i?r.push("greater than or equal to "+e):o&&r.push("less than or equal to "+t),Zi(r=>xr(r)&&(!i||r>=e)&&(!o||r<=t),r.join(" "))}})}(Zi(xr,"a number")),gi=Zi(e=>Sr(e)&&isNaN(e),"NaN"),yi=fi.restrict({min:0}),vi=fi.restrict({min:0,max:1}),mi=fi.restrict({min:-360,max:360}),Ci=ci(fi,gi),bi=function(e){return Object.assign(e,{restrict:({length:e,minLength:t}={})=>Zi(r=>pr(r)&&(!Sr(e)||r.length===e)&&(!Sr(t)||r.length>=t),Sr(t)&&t>0?"a non-empty array":Sr(e)?"an array of length "+e:"an array")})}(Zi(pr,"an array")),Si=(e,t)=>Zi((t,r)=>pr(t)&&t.every(t=>e(t,r)),e=>{var r;const i=null!=(r=Ji(bi,e))?r:"";return t?`${i} of ${t}`:i}),xi=e=>xr(e)||gr(e),wi=e=>Zi((t,r)=>!xi(t)||!xi(r.target[e])||t<r.target[e],"expected to be less than "+e),Ei=e=>Zi((t,r)=>!xi(t)||!xi(r.target[e])||t>r.target[e],"expected to be greater than "+e),Ai=Zi(gr,"Date object"),Oi=ci(Ai,yi),Pi="A color string can be in one of the following formats to be valid: #rgb, #rrggbb, rgb(r, g, b), rgba(r, g, b, a) or a CSS color name such as 'white', 'orange', 'cyan', etc",Ti=Zi(e=>br(e)&&ni.validColorString(e),"color String. "+Pi),Di=Zi(Si(Ti),"color strings. "+Pi),Ri=Si(di,"boolean values"),Mi=Si(fi,"numbers"),_i=Si(hi,"strings"),ki=Zi(Si(Ai),"Date objects"),Li=Zi(Si(ui),"objects"),Fi=Xi(["butt","round","square"],"a line cap"),Ii=Xi(["round","bevel","miter"],"a line join"),Ni=Zi(Si(yi),"numbers specifying the length in pixels of alternating dashes and gaps, for example, [6, 3] means dashes with a length of 6 pixels with gaps between of 3 pixels."),Gi=Xi(["top","right","bottom","left"],"a position"),Bi=Xi(["normal","italic","oblique"],"a font style"),Vi=ci(Xi(["normal","bold","bolder","lighter"],"a font weight"),fi.restrict({min:1,max:1e3})),ji=Xi(["never","always","hyphenate","on-space"],"a text wrap strategy"),Ui=Xi(["left","center","right"],"a text align"),Hi=Xi(["top","middle","bottom"],"a vertical align"),Wi=Xi(["ellipsis","hide"],"an overflow strategy"),zi=Xi(["horizontal","vertical"],"a direction"),Ki=Xi(["inside","outside"],"a placement"),Yi=ci(Xi(["exact","nearest"],"interaction range"),fi);function Xi(e,t="a"){return Zi(t=>e.includes(t),`${t} keyword such as ${function(e){const t=e.map(e=>`'${e}'`);if(1===t.length)return t[0];const r=t.pop();return`${t.join(", ")} or ${r}`}(e)}`)}var qi=ci(li(fi.restrict({min:1}),wi("maxSpacing")),gi),$i=ci(li(fi.restrict({min:1}),Ei("minSpacing")),gi);function Zi(e,t){return e.message=t,e}function Ji(e,t){return yr(e.message)?e.message(t):e.message}function Qi(e){if("number"==typeof e){if(isNaN(e))return"NaN";if(e===1/0)return"Infinity";if(e===-1/0)return"-Infinity"}return JSON.stringify(e)}var eo=(e=>(e.X="x",e.Y="y",e))(eo||{}),to={};function ro(){for(const e in to)delete to[e]}function io(e){var t;const r=e.constructor,i=Object.hasOwn(r,"className")?r.className:r.name;if(!i)throw new Error(`The ${r} is missing the 'className' property.`);const o=(null!=(t=to[i])?t:0)+1;return to[i]=o,i+"-"+o}function oo(e,t,r=1/0){const i={nearest:void 0,distanceSquared:r};for(const r of t){const t=r.distanceSquared(e);if(0===t)return{nearest:r,distanceSquared:0};t<i.distanceSquared&&(i.nearest=r,i.distanceSquared=t)}return i}function no(e,t,r=1/0){const i=t.transformPoint(e.x,e.y),o={nearest:void 0,distanceSquared:r};for(const e of t.children){const{nearest:t,distanceSquared:r}=e.nearestSquared(i,o.distanceSquared);if(0===r)return{nearest:t,distanceSquared:r};r<o.distanceSquared&&(o.nearest=t,o.distanceSquared=r)}return o}var ao=class e{constructor(e,t,r,i){this.x=e,this.y=t,this.width=r,this.height=i}clone(){const{x:t,y:r,width:i,height:o}=this;return new e(t,r,i,o)}equals(e){return this.x===e.x&&this.y===e.y&&this.width===e.width&&this.height===e.height}containsPoint(e,t){return e>=this.x&&e<=this.x+this.width&&t>=this.y&&t<=this.y+this.height}collidesBBox(e){return this.x<e.x+e.width&&this.x+this.width>e.x&&this.y<e.y+e.height&&this.y+this.height>e.y}isInfinite(){return Math.abs(this.x)===1/0||Math.abs(this.y)===1/0||Math.abs(this.width)===1/0||Math.abs(this.height)===1/0}distanceSquared(e){if(this.containsPoint(e.x,e.y))return 0;const t=e.x-Math.max(this.x,Math.min(e.x,this.x+this.width)),r=e.y-Math.max(this.y,Math.min(e.y,this.y+this.height));return t*t+r*r}static nearestBox(e,t){return oo(e,t)}shrink(e,t){const r=(e,t)=>{switch(e){case"top":this.y+=t;case"bottom":this.height-=t;break;case"left":this.x+=t;case"right":this.width-=t;break;case"vertical":this.y+=t,this.height-=2*t;break;case"horizontal":this.x+=t,this.width-=2*t;break;case void 0:this.x+=t,this.width-=2*t,this.y+=t,this.height-=2*t}};return"number"==typeof e?r(t,e):"object"==typeof e&&Object.entries(e).forEach(([e,t])=>r(e,t)),this}grow(e,t){if("number"==typeof e)this.shrink(-e,t);else{const t=We({},e);for(const e in t)t[e]*=-1;this.shrink(t)}return this}static merge(t){let r=1/0,i=1/0,o=-1/0,n=-1/0;return t.forEach(e=>{e.x<r&&(r=e.x),e.y<i&&(i=e.y),e.x+e.width>o&&(o=e.x+e.width),e.y+e.height>n&&(n=e.y+e.height)}),new e(r,i,o-r,n-i)}};ao.zero=new ao(0,0,0,0);var so=ao,lo=class e{get e(){return[...this.elements]}constructor(e=[1,0,0,1,0,0]){this.elements=e}setElements(e){const t=this.elements;return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],this}get identity(){const e=this.elements;return 1===e[0]&&0===e[1]&&0===e[2]&&1===e[3]&&0===e[4]&&0===e[5]}AxB(e,t,r){const i=e[0]*t[0]+e[2]*t[1],o=e[1]*t[0]+e[3]*t[1],n=e[0]*t[2]+e[2]*t[3],a=e[1]*t[2]+e[3]*t[3],s=e[0]*t[4]+e[2]*t[5]+e[4],l=e[1]*t[4]+e[3]*t[5]+e[5];(r=null!=r?r:e)[0]=i,r[1]=o,r[2]=n,r[3]=a,r[4]=s,r[5]=l}multiplySelf(e){return this.AxB(this.elements,e.elements),this}multiply(t){const r=new Array(6);return this.AxB(this.elements,t.elements,r),new e(r)}preMultiplySelf(e){return this.AxB(e.elements,this.elements,this.elements),this}inverse(){const t=this.elements;let r=t[0],i=t[1],o=t[2],n=t[3];const a=t[4],s=t[5],l=1/(r*n-i*o);return r*=l,i*=l,o*=l,n*=l,new e([n,-i,-o,r,o*s-n*a,i*a-r*s])}inverseTo(e){const t=this.elements;let r=t[0],i=t[1],o=t[2],n=t[3];const a=t[4],s=t[5],l=1/(r*n-i*o);return r*=l,i*=l,o*=l,n*=l,e.setElements([n,-i,-o,r,o*s-n*a,i*a-r*s]),this}invertSelf(){const e=this.elements;let t=e[0],r=e[1],i=e[2],o=e[3];const n=e[4],a=e[5],s=1/(t*o-r*i);return t*=s,r*=s,i*=s,o*=s,e[0]=o,e[1]=-r,e[2]=-i,e[3]=t,e[4]=i*a-o*n,e[5]=r*n-t*a,this}transformPoint(e,t){const r=this.elements;return{x:e*r[0]+t*r[2]+r[4],y:e*r[1]+t*r[3]+r[5]}}transformBBox(e,t){const r=this.elements,i=r[0],o=r[1],n=r[2],a=r[3],s=.5*e.width,l=.5*e.height,c=e.x+s,u=e.y+l,d=Math.abs(s*i)+Math.abs(l*n),p=Math.abs(s*o)+Math.abs(l*a);return t||(t=new so(0,0,0,0)),t.x=c*i+u*n+r[4]-d,t.y=c*o+u*a+r[5]-p,t.width=d+d,t.height=p+p,t}toContext(e){if(this.identity)return;const t=this.elements;e.transform(t[0],t[1],t[2],t[3],t[4],t[5])}static flyweight(t){return e.instance.setElements(t.elements)}static updateTransformMatrix(e,t,r,i,o,n,a){const[s,l]=[0,0],c=t,u=r;let d,p;1===c&&1===u?(d=0,p=0):(d=null==(null==a?void 0:a.scalingCenterX)?s:null==a?void 0:a.scalingCenterX,p=null==(null==a?void 0:a.scalingCenterY)?l:null==a?void 0:a.scalingCenterY);const h=i,f=Math.cos(h),g=Math.sin(h);let y,v;0===h?(y=0,v=0):(y=null==(null==a?void 0:a.rotationCenterX)?s:null==a?void 0:a.rotationCenterX,v=null==(null==a?void 0:a.rotationCenterY)?l:null==a?void 0:a.rotationCenterY);const m=o,C=n,b=d*(1-c)-y,S=p*(1-u)-v;return e.setElements([f*c,g*c,-g*u,f*u,f*b-g*S+y+m,g*b+f*S+v+C]),e}static fromContext(t){const r=t.getTransform();return new e([r.a,r.b,r.c,r.d,r.e,r.f])}};lo.instance=new lo;var co=lo,uo=(e=>(e[e.All=0]="All",e[e.None=1]="None",e))(uo||{}),po=e=>{e.parent&&(e.parent.dirtyZIndex=!0),e.zIndexChanged()},ho=class e extends ur{constructor({isVirtual:t,tag:r}={}){super(),this.serialNumber=e._nextSerialNumber++,this.id=io(this),this.isContainerNode=!1,this._virtualChildren=[],this._children=[],this.childSet={},this.matrix=new co,this.inverseMatrix=new co,this.dirtyTransform=!1,this.scalingX=1,this.scalingY=1,this.scalingCenterX=null,this.scalingCenterY=null,this.rotationCenterX=null,this.rotationCenterY=null,this.rotation=0,this.translationX=0,this.translationY=0,this.visible=!0,this.dirtyZIndex=!1,this.zIndex=0,this.zIndexSubOrder=void 0,this.pointerEvents=0,this.isVirtual=null!=t&&t,this.tag=null!=r?r:NaN}get datum(){var e,t;return null!=(t=this._datum)?t:null==(e=this._parent)?void 0:e.datum}get previousDatum(){return this._previousDatum}set datum(e){this._datum!==e&&(this._previousDatum=this._datum),this._datum=e}_setLayerManager(e){this._layerManager=e,this._debug=null==e?void 0:e.debug;for(const t of this._children)t._setLayerManager(e);for(const t of this._virtualChildren)t._setLayerManager(e)}get layerManager(){return this._layerManager}get parent(){return this._parent}get children(){if(0===this._virtualChildren.length)return this._children;const e=[...this._children];for(const t of this._virtualChildren)e.push(...t.children);return e}get virtualChildren(){return this._virtualChildren}hasVirtualChildren(){return this._virtualChildren.length>0}setProperties(e,t){const r=null!=t?t:Object.keys(e);for(const t of r)this[t]=e[t];return this}append(e){Array.isArray(e)||(e=[e]);for(const t of e){if(t.parent)throw new Error(`${t} already belongs to another parent: ${t.parent}.`);if(t.layerManager)throw new Error(`${t} already belongs to a scene: ${t.layerManager}.`);if(this.childSet[t.id])throw new Error(`Duplicate ${t.constructor.name} node: ${t}`);t.isVirtual?this._virtualChildren.push(t):this._children.push(t),this.childSet[t.id]=!0,t._parent=this,t._setLayerManager(this.layerManager)}this.dirtyZIndex=!0,this.markDirty(this,3)}appendChild(e){return this.append(e),e}removeChild(e){const t=()=>{throw new Error("The node to be removed is not a child of this node.")};if(e.parent!==this&&t(),e.isVirtual){const r=this._virtualChildren.indexOf(e);r<0&&t(),this._virtualChildren.splice(r,1)}else{const r=this._children.indexOf(e);r<0&&t(),this._children.splice(r,1)}return delete this.childSet[e.id],e._parent=void 0,e._setLayerManager(),this.dirtyZIndex=!0,this.markDirty(e,3),e}calculateCumulativeMatrix(){this.computeTransformMatrix();const e=co.flyweight(this.matrix);let t=this.parent;for(;t;)t.computeTransformMatrix(),e.preMultiplySelf(t.matrix),t=t.parent;return e}transformPoint(e,t){return this.calculateCumulativeMatrix().invertSelf().transformPoint(e,t)}inverseTransformPoint(e,t){return this.calculateCumulativeMatrix().transformPoint(e,t)}transformBBox(e){return this.calculateCumulativeMatrix().invertSelf().transformBBox(e)}inverseTransformBBox(e){return this.calculateCumulativeMatrix().transformBBox(e)}markDirtyTransform(){this.dirtyTransform=!0,this.markDirty(this,3)}containsPoint(e,t){return!1}pickNode(e,t){var r;if(!this.visible||1===this.pointerEvents||!this.containsPoint(e,t))return;const i=this.children;if(i.length>1e3)for(let o=i.length-1;o>=0;o--){const n=i[o],a=(null==(r=n.computeTransformedBBox())?void 0:r.containsPoint(e,t))?n.pickNode(e,t):void 0;if(a)return a}else if(i.length)for(let r=i.length-1;r>=0;r--){const o=i[r].pickNode(e,t);if(o)return o}else if(!this.isContainerNode)return this}findNodes(e){const t=e(this)?[this]:[];for(const r of this.children){const i=r.findNodes(e);i&&t.push(...i)}return t}computeBBox(){}computeTransformedBBox(){const e=this.computeBBox();if(!e)return;this.computeTransformMatrix();const t=co.flyweight(this.matrix);let r=this.parent;for(;r;)r.computeTransformMatrix(),t.preMultiplySelf(r.matrix),r=r.parent;return t.transformBBox(e,e),e}computeTransformMatrix(){if(!this.dirtyTransform)return;const{matrix:e,scalingX:t,scalingY:r,rotation:i,translationX:o,translationY:n,scalingCenterX:a,scalingCenterY:s,rotationCenterX:l,rotationCenterY:c}=this;co.updateTransformMatrix(e,t,r,i,o,n,{scalingCenterX:a,scalingCenterY:s,rotationCenterX:l,rotationCenterY:c}),e.inverseTo(this.inverseMatrix),this.dirtyTransform=!1}render(e){const{stats:t}=e;this._dirty=0,t&&t.nodesRendered++}clearBBox(e){const t=this.computeBBox();if(null==t)return;const{x:r,y:i,width:o,height:n}=t,a=this.transformPoint(r,i),s=this.transformPoint(r+o,i+n);e.clearRect(a.x,a.y,s.x-a.x,s.y-a.y)}markDirty(e,t=1,r=t){this._dirty>t||this._dirty===t&&t===r||(this._dirty=t,this.parent?this.parent.markDirty(this,r):this.layerManager&&this.layerManager.markDirty())}get dirty(){return this._dirty}markClean(e){const{force:t=!1,recursive:r=!0}=null!=e?e:{};if(0!==this._dirty||t){if(this._dirty=0,!1!==r)for(const e of this._virtualChildren)e.markClean({force:t});if(!0===r)for(const e of this._children)e.markClean({force:t})}}visibilityChanged(){}get nodeCount(){let e=1,t=this._dirty>=0||this.dirtyTransform?1:0,r=this.visible?1:0;const i=i=>{const{count:o,visibleCount:n,dirtyCount:a}=i.nodeCount;e+=o,r+=n,t+=a};for(const e of this._children)i(e);for(const e of this._virtualChildren)i(e);return{count:e,visibleCount:r,dirtyCount:t}}zIndexChanged(){}};ho._nextSerialNumber=0,Xe([cr({type:"transform"})],ho.prototype,"scalingX",2),Xe([cr({type:"transform"})],ho.prototype,"scalingY",2),Xe([cr({type:"transform"})],ho.prototype,"scalingCenterX",2),Xe([cr({type:"transform"})],ho.prototype,"scalingCenterY",2),Xe([cr({type:"transform"})],ho.prototype,"rotationCenterX",2),Xe([cr({type:"transform"})],ho.prototype,"rotationCenterY",2),Xe([cr({type:"transform"})],ho.prototype,"rotation",2),Xe([cr({type:"transform"})],ho.prototype,"translationX",2),Xe([cr({type:"transform"})],ho.prototype,"translationY",2),Xe([cr({redraw:3,changeCb:e=>e.visibilityChanged()})],ho.prototype,"visible",2),Xe([cr({redraw:1,changeCb:po})],ho.prototype,"zIndex",2),Xe([cr({redraw:1,changeCb:po})],ho.prototype,"zIndexSubOrder",2);var fo=ho;function go(){if("undefined"==typeof navigator)return!1;const e=navigator.userAgent.match(/\(iPhone; CPU iPhone OS (\d+_\d+_\d+) like Mac OS X\)/);if(null==e)return!1;const t=e[1].split("_"),r=Number(t[0]);if(r>16)return!1;if(16===r){return Number(t[1])<6}return!0}var yo=class e{constructor(t){this._enabled=!0,this._pixelRatio=NaN,this._width=0,this._height=0;const{document:r,window:i,width:o=600,height:n=300,domLayer:a=!1,zIndex:s=0,name:l,overrideDevicePixelRatio:c}=t;this.document=r,this.window=i,e.document=r,this.element=r.createElement("canvas"),this.element.width=o,this.element.height=n,this.realContext=this.element.getContext("2d"),this.imageSource=this.realContext.canvas;const{style:u}=this.element;u.userSelect="none",u.display="block",a&&(u.position="absolute",u.zIndex=String(s),u.top="0",u.left="0",u.pointerEvents="none",u.opacity="1",l&&(this.element.id=l)),this.context=this.setPixelRatio(c),this.resize(o,n)}set container(e){this._container!==e&&(this.remove(),e&&e.appendChild(this.element),this._container=e)}get container(){return this._container}set enabled(e){this.element.style.display=e?"block":"none",this._enabled=!!e}get enabled(){return this._enabled}remove(){const{parentNode:e}=this.element;null!=e&&e.removeChild(this.element)}destroy(){this.element.remove(),this.element.width=0,this.element.height=0,this.context.clearRect(0,0,0,0),Object.freeze(this)}snapshot(){}clear(){this.context.save(),this.context.resetTransform(),this.context.clearRect(0,0,this.width,this.height),this.context.restore()}toImage(){const e=this.document.createElement("img");return e.src=this.getDataURL(),e}getDataURL(e){return this.element.toDataURL(e)}download(e,t="image/png"){e=(null!=e?e:"").trim()||"image";const r=this.getDataURL(t),i=this.document,o=i.createElement("a");o.href=r,o.download=e,o.style.display="none",i.body.appendChild(o),o.click(),i.body.removeChild(o)}get pixelRatio(){return this._pixelRatio}setPixelRatio(t){let r=null!=t?t:this.window.devicePixelRatio;return go()&&(r=1),this._pixelRatio=r,e.overrideScale(this.realContext,r)}set pixelated(e){this.element.style.imageRendering=e?"pixelated":"auto"}get pixelated(){return"pixelated"===this.element.style.imageRendering}get width(){return this._width}get height(){return this._height}resize(e,t){if(!(e>0&&t>0))return;const{element:r,context:i,pixelRatio:o}=this;r.width=Math.round(e*o),r.height=Math.round(t*o),r.style.width=e+"px",r.style.height=t+"px",i.resetTransform(),this._width=e,this._height=t}static get textMeasuringContext(){if(this._textMeasuringContext)return this._textMeasuringContext;const e=this.document.createElement("canvas");return this._textMeasuringContext=e.getContext("2d"),this._textMeasuringContext}static get svgText(){if(this._svgText)return this._svgText;const e="http: